; generated by ARM C/C++ Compiler, 4.1 [Build 894]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\Obj\menu.o --asm_dir=.\List\ --list_dir=.\List\ --depend=.\Obj\menu.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\Libraries\CMSIS\CM3\CoreSupport -I..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\startup\arm -I..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\User -I..\BaseDrive -I..\Ucosii -I..\Ucosii\Port -I..\Ucosii\Src -I..\Ucosii\Include -I..\Ucgui -I..\Ucgui\Config -I..\Ucgui\GUI_X -I..\Ucgui\GUI -I..\Ucgui\GUI\ConvertColor -I..\Ucgui\GUI\ConvertMono -I..\Ucgui\GUI\Core -I..\Ucgui\GUI\Core -I..\Ucgui\GUI\LCDDriver -I..\Ucgui\GUI\MultiLayer -I..\Ucgui\GUI\Widget -I..\Ucgui\GUI\WM -I..\ExternalDrive\Lcd -I..\ExternalDrive\Touch -I..\Panel -I"D:\Program files\Keil\ARM\RV31\Inc" -I"D:\Program files\Keil\ARM\CMSIS\Include" -I"D:\Program files\Keil\ARM\Inc\ST\STM32F10x" -D__MICROLIB -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=.\Obj\menu.crf ..\Ucgui\GUI\Widget\MENU.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  MENU__SendMenuMessage PROC
;;;1110   */
;;;1111   int MENU__SendMenuMessage(MENU_Handle hObj, WM_HWIN hDestWin, U16 MsgType, U16 ItemId) {
000000  e92d41ff          PUSH     {r0-r8,lr}
000004  4605              MOV      r5,r0
000006  460c              MOV      r4,r1
000008  4616              MOV      r6,r2
00000a  461f              MOV      r7,r3
;;;1112     MENU_MSG_DATA MsgData;
;;;1113     WM_MESSAGE    Msg = {0};
00000c  2000              MOVS     r0,#0
00000e  9000              STR      r0,[sp,#0]
000010  9001              STR      r0,[sp,#4]
000012  9002              STR      r0,[sp,#8]
;;;1114     MsgData.MsgType   = MsgType;
000014  f8ad600c          STRH     r6,[sp,#0xc]
;;;1115     MsgData.ItemId    = ItemId;
000018  f8ad700e          STRH     r7,[sp,#0xe]
;;;1116     Msg.MsgId         = WM_MENU;
00001c  202c              MOVS     r0,#0x2c
00001e  9000              STR      r0,[sp,#0]
;;;1117     Msg.Data.p        = &MsgData;
000020  a803              ADD      r0,sp,#0xc
000022  9002              STR      r0,[sp,#8]
;;;1118     Msg.hWinSrc       = hObj;
000024  f8ad5006          STRH     r5,[sp,#6]
;;;1119     if (!hDestWin) {
000028  b91c              CBNZ     r4,|L1.50|
;;;1120       hDestWin = WM_GetParent(hObj);
00002a  4628              MOV      r0,r5
00002c  f7fffffe          BL       WM_GetParent
000030  4604              MOV      r4,r0
                  |L1.50|
;;;1121     }
;;;1122     if (hDestWin) {
000032  b13c              CBZ      r4,|L1.68|
;;;1123       WM__SendMessage(hDestWin, &Msg);
000034  4669              MOV      r1,sp
000036  4620              MOV      r0,r4
000038  f7fffffe          BL       WM__SendMessage
;;;1124       return Msg.Data.v;
00003c  9802              LDR      r0,[sp,#8]
                  |L1.62|
;;;1125     }
;;;1126     return 0;
;;;1127   }
00003e  b004              ADD      sp,sp,#0x10
000040  e8bd81f0          POP      {r4-r8,pc}
                  |L1.68|
000044  2000              MOVS     r0,#0                 ;1126
000046  e7fa              B        |L1.62|
;;;1128   
                          ENDP

                  _IsTopLevelMenu PROC
;;;186    */
;;;187    static char _IsTopLevelMenu(MENU_Handle hObj, const MENU_Obj* pObj) {
000048  b570              PUSH     {r4-r6,lr}
00004a  4605              MOV      r5,r0
00004c  460c              MOV      r4,r1
;;;188      if (MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_IS_MENU, 0) == 0) {
00004e  f9b4105c          LDRSH    r1,[r4,#0x5c]
000052  2300              MOVS     r3,#0
000054  2205              MOVS     r2,#5
000056  4628              MOV      r0,r5
000058  f7fffffe          BL       MENU__SendMenuMessage
00005c  b908              CBNZ     r0,|L1.98|
;;;189        return 1;
00005e  2001              MOVS     r0,#1
                  |L1.96|
;;;190      }
;;;191      return 0;
;;;192    }
000060  bd70              POP      {r4-r6,pc}
                  |L1.98|
000062  2000              MOVS     r0,#0                 ;191
000064  e7fc              B        |L1.96|
;;;193    
                          ENDP

                  _HasEffect PROC
;;;197    */
;;;198    static int _HasEffect(MENU_Handle hObj, MENU_Obj* pObj) {
000066  b570              PUSH     {r4-r6,lr}
000068  4605              MOV      r5,r0
00006a  460c              MOV      r4,r1
;;;199      if (!(pObj->Flags & MENU_SF_POPUP)) {
00006c  f8b4005e          LDRH     r0,[r4,#0x5e]
000070  f0100f80          TST      r0,#0x80
000074  d106              BNE      |L1.132|
;;;200        if (_IsTopLevelMenu(hObj, pObj)) {
000076  4621              MOV      r1,r4
000078  4628              MOV      r0,r5
00007a  f7fffffe          BL       _IsTopLevelMenu
00007e  b108              CBZ      r0,|L1.132|
;;;201          return 0;
000080  2000              MOVS     r0,#0
                  |L1.130|
;;;202        }
;;;203      }
;;;204      return 1;
;;;205    }
000082  bd70              POP      {r4-r6,pc}
                  |L1.132|
000084  2001              MOVS     r0,#1                 ;204
000086  e7fc              B        |L1.130|
;;;206    
                          ENDP

                  _GetEffectSize PROC
;;;210    */
;;;211    static int _GetEffectSize(MENU_Handle hObj, MENU_Obj* pObj) {
000088  b570              PUSH     {r4-r6,lr}
00008a  4605              MOV      r5,r0
00008c  460c              MOV      r4,r1
;;;212      int r = 0;
00008e  2600              MOVS     r6,#0
;;;213      if (_HasEffect(hObj, pObj)) { 
000090  4621              MOV      r1,r4
000092  4628              MOV      r0,r5
000094  f7fffffe          BL       _HasEffect
000098  b108              CBZ      r0,|L1.158|
;;;214        r = pObj->Widget.pEffect->EffectSize;
00009a  6a20              LDR      r0,[r4,#0x20]
00009c  6946              LDR      r6,[r0,#0x14]
                  |L1.158|
;;;215      }
;;;216      return r;
00009e  4630              MOV      r0,r6
;;;217    }
0000a0  bd70              POP      {r4-r6,pc}
;;;218    
                          ENDP

                  _CalcTextWidth PROC
;;;222    */
;;;223    static int _CalcTextWidth(MENU_Obj* pObj, const char GUI_UNI_PTR* sText) {
0000a2  e92d41f0          PUSH     {r4-r8,lr}
0000a6  4605              MOV      r5,r0
0000a8  460c              MOV      r4,r1
;;;224      int TextWidth = 0;
0000aa  2600              MOVS     r6,#0
;;;225      if (sText) {
0000ac  b15c              CBZ      r4,|L1.198|
;;;226        const GUI_FONT GUI_UNI_PTR* pOldFont;
;;;227        pOldFont  = GUI_SetFont(pObj->Props.pFont);
0000ae  6d68              LDR      r0,[r5,#0x54]
0000b0  f7fffffe          BL       GUI_SetFont
0000b4  4607              MOV      r7,r0
;;;228        TextWidth = GUI_GetStringDistX(sText);
0000b6  4620              MOV      r0,r4
0000b8  f7fffffe          BL       GUI_GetStringDistX
0000bc  4606              MOV      r6,r0
;;;229        GUI_SetFont(pOldFont);
0000be  4638              MOV      r0,r7
0000c0  f7fffffe          BL       GUI_SetFont
;;;230      }
0000c4  bf00              NOP      
                  |L1.198|
;;;231      return TextWidth;
0000c6  4630              MOV      r0,r6
;;;232    }
0000c8  e8bd81f0          POP      {r4-r8,pc}
;;;233    
                          ENDP

                  _GetItemWidth PROC
;;;237    */
;;;238    static int _GetItemWidth(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0000cc  e92d41f0          PUSH     {r4-r8,lr}
0000d0  4680              MOV      r8,r0
0000d2  460c              MOV      r4,r1
0000d4  4616              MOV      r6,r2
;;;239      int ItemWidth;
;;;240      if (pObj->Width && (pObj->Flags & MENU_SF_VERTICAL)) {
0000d6  6e60              LDR      r0,[r4,#0x64]
0000d8  b160              CBZ      r0,|L1.244|
0000da  f8b4005e          LDRH     r0,[r4,#0x5e]
0000de  f0100f01          TST      r0,#1
0000e2  d007              BEQ      |L1.244|
;;;241        ItemWidth = pObj->Width - (_GetEffectSize(hObj, pObj) << 1);
0000e4  4621              MOV      r1,r4
0000e6  4640              MOV      r0,r8
0000e8  f7fffffe          BL       _GetEffectSize
0000ec  6e61              LDR      r1,[r4,#0x64]
0000ee  eba10540          SUB      r5,r1,r0,LSL #1
0000f2  e018              B        |L1.294|
                  |L1.244|
;;;242      } else {
;;;243        MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0000f4  4631              MOV      r1,r6
0000f6  f1040058          ADD      r0,r4,#0x58
0000fa  f7fffffe          BL       GUI_ARRAY_GetpItem
0000fe  4607              MOV      r7,r0
;;;244        if ((pObj->Flags & MENU_SF_VERTICAL) || !(pItem->Flags & MENU_IF_SEPARATOR)) {
000100  f8b4005e          LDRH     r0,[r4,#0x5e]
000104  f0100f01          TST      r0,#1
000108  d103              BNE      |L1.274|
00010a  88b8              LDRH     r0,[r7,#4]
00010c  f0100f02          TST      r0,#2
000110  d101              BNE      |L1.278|
                  |L1.274|
;;;245          ItemWidth = pItem->TextWidth;
000112  68bd              LDR      r5,[r7,#8]
000114  e000              B        |L1.280|
                  |L1.278|
;;;246        } else {
;;;247          ItemWidth = 3;
000116  2503              MOVS     r5,#3
                  |L1.280|
;;;248       }
;;;249        ItemWidth += pObj->Props.aBorder[MENU_BI_LEFT] + pObj->Props.aBorder[MENU_BI_RIGHT];
000118  f8941050          LDRB     r1,[r4,#0x50]
00011c  f8940051          LDRB     r0,[r4,#0x51]
000120  4408              ADD      r0,r0,r1
000122  4405              ADD      r5,r5,r0
;;;250      }
000124  bf00              NOP      
                  |L1.294|
;;;251      return ItemWidth;
000126  4628              MOV      r0,r5
;;;252    }
000128  e8bd81f0          POP      {r4-r8,pc}
;;;253    
                          ENDP

                  _GetItemHeight PROC
;;;257    */
;;;258    static int _GetItemHeight(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
00012c  e92d41f0          PUSH     {r4-r8,lr}
000130  4607              MOV      r7,r0
000132  460c              MOV      r4,r1
000134  4616              MOV      r6,r2
;;;259      int ItemHeight;
;;;260      if (pObj->Height && !(pObj->Flags & MENU_SF_VERTICAL)) {
000136  6ea0              LDR      r0,[r4,#0x68]
000138  b160              CBZ      r0,|L1.340|
00013a  f8b4005e          LDRH     r0,[r4,#0x5e]
00013e  f0100f01          TST      r0,#1
000142  d107              BNE      |L1.340|
;;;261        ItemHeight = pObj->Height - (_GetEffectSize(hObj, pObj) << 1);
000144  4621              MOV      r1,r4
000146  4638              MOV      r0,r7
000148  f7fffffe          BL       _GetEffectSize
00014c  6ea1              LDR      r1,[r4,#0x68]
00014e  eba10540          SUB      r5,r1,r0,LSL #1
000152  e01b              B        |L1.396|
                  |L1.340|
;;;262      } else {
;;;263        ItemHeight = GUI_GetYDistOfFont(pObj->Props.pFont);
000154  6d60              LDR      r0,[r4,#0x54]
000156  f7fffffe          BL       GUI_GetYDistOfFont
00015a  4605              MOV      r5,r0
;;;264        if (pObj->Flags & MENU_SF_VERTICAL) {
00015c  f8b4005e          LDRH     r0,[r4,#0x5e]
000160  f0100f01          TST      r0,#1
000164  d00c              BEQ      |L1.384|
;;;265          MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000166  4631              MOV      r1,r6
000168  f1040058          ADD      r0,r4,#0x58
00016c  f7fffffe          BL       GUI_ARRAY_GetpItem
000170  4680              MOV      r8,r0
;;;266          if (pItem->Flags & MENU_IF_SEPARATOR) {
000172  f8b80004          LDRH     r0,[r8,#4]
000176  f0100f02          TST      r0,#2
00017a  d000              BEQ      |L1.382|
;;;267            ItemHeight = 3;
00017c  2503              MOVS     r5,#3
                  |L1.382|
;;;268          }
;;;269        }
00017e  bf00              NOP      
                  |L1.384|
;;;270        ItemHeight += pObj->Props.aBorder[MENU_BI_TOP] + pObj->Props.aBorder[MENU_BI_BOTTOM];
000180  f8941052          LDRB     r1,[r4,#0x52]
000184  f8940053          LDRB     r0,[r4,#0x53]
000188  4408              ADD      r0,r0,r1
00018a  4405              ADD      r5,r5,r0
                  |L1.396|
;;;271      }
;;;272      return ItemHeight;
00018c  4628              MOV      r0,r5
;;;273    }
00018e  e8bd81f0          POP      {r4-r8,pc}
;;;274    
                          ENDP

                  MENU__GetNumItems PROC
;;;1026   */
;;;1027   unsigned MENU__GetNumItems(MENU_Obj* pObj) {
000192  b510              PUSH     {r4,lr}
000194  4604              MOV      r4,r0
;;;1028     return GUI_ARRAY_GetNumItems(&pObj->ItemArray);
000196  f1040058          ADD      r0,r4,#0x58
00019a  f7fffffe          BL       GUI_ARRAY_GetNumItems
;;;1029   }
00019e  bd10              POP      {r4,pc}
;;;1030   
                          ENDP

                  _CalcMenuSizeX PROC
;;;278    */
;;;279    static int _CalcMenuSizeX(MENU_Handle hObj, MENU_Obj* pObj) {
0001a0  e92d47f0          PUSH     {r4-r10,lr}
0001a4  4681              MOV      r9,r0
0001a6  460f              MOV      r7,r1
;;;280      unsigned i, NumItems = MENU__GetNumItems(pObj);
0001a8  4638              MOV      r0,r7
0001aa  f7fffffe          BL       MENU__GetNumItems
0001ae  4680              MOV      r8,r0
;;;281      int xSize = 0;
0001b0  2500              MOVS     r5,#0
;;;282      if (pObj->Flags & MENU_SF_VERTICAL) {
0001b2  f8b7005e          LDRH     r0,[r7,#0x5e]
0001b6  f0100f01          TST      r0,#1
0001ba  d00e              BEQ      |L1.474|
;;;283        int ItemWidth;
;;;284        for (i = 0; i < NumItems; i++) {
0001bc  2400              MOVS     r4,#0
0001be  e009              B        |L1.468|
                  |L1.448|
;;;285          ItemWidth = _GetItemWidth(hObj, pObj, i);
0001c0  4622              MOV      r2,r4
0001c2  4639              MOV      r1,r7
0001c4  4648              MOV      r0,r9
0001c6  f7fffffe          BL       _GetItemWidth
0001ca  4606              MOV      r6,r0
;;;286          if (ItemWidth > xSize) {
0001cc  42ae              CMP      r6,r5
0001ce  dd00              BLE      |L1.466|
;;;287            xSize = ItemWidth;
0001d0  4635              MOV      r5,r6
                  |L1.466|
0001d2  1c64              ADDS     r4,r4,#1              ;284
                  |L1.468|
0001d4  4544              CMP      r4,r8                 ;284
0001d6  d3f3              BCC      |L1.448|
;;;288          }
;;;289        }
;;;290      } else {
0001d8  e00a              B        |L1.496|
                  |L1.474|
;;;291        for (i = 0; i < NumItems; i++) {
0001da  2400              MOVS     r4,#0
0001dc  e006              B        |L1.492|
                  |L1.478|
;;;292          xSize += _GetItemWidth(hObj, pObj, i);
0001de  4622              MOV      r2,r4
0001e0  4639              MOV      r1,r7
0001e2  4648              MOV      r0,r9
0001e4  f7fffffe          BL       _GetItemWidth
0001e8  4405              ADD      r5,r5,r0
0001ea  1c64              ADDS     r4,r4,#1              ;291
                  |L1.492|
0001ec  4544              CMP      r4,r8                 ;291
0001ee  d3f6              BCC      |L1.478|
                  |L1.496|
;;;293        }
;;;294      }
;;;295      xSize += (_GetEffectSize(hObj, pObj) << 1);
0001f0  4639              MOV      r1,r7
0001f2  4648              MOV      r0,r9
0001f4  f7fffffe          BL       _GetEffectSize
0001f8  eb050540          ADD      r5,r5,r0,LSL #1
;;;296      return xSize;
0001fc  4628              MOV      r0,r5
;;;297    }
0001fe  e8bd87f0          POP      {r4-r10,pc}
;;;298    
                          ENDP

                  _CalcMenuSizeY PROC
;;;302    */
;;;303    static int _CalcMenuSizeY(MENU_Handle hObj, MENU_Obj* pObj) {
000202  e92d47f0          PUSH     {r4-r10,lr}
000206  4681              MOV      r9,r0
000208  460f              MOV      r7,r1
;;;304      unsigned i, NumItems = MENU__GetNumItems(pObj);
00020a  4638              MOV      r0,r7
00020c  f7fffffe          BL       MENU__GetNumItems
000210  4680              MOV      r8,r0
;;;305      int ySize = 0;
000212  2500              MOVS     r5,#0
;;;306      if (pObj->Flags & MENU_SF_VERTICAL) {
000214  f8b7005e          LDRH     r0,[r7,#0x5e]
000218  f0100f01          TST      r0,#1
00021c  d00b              BEQ      |L1.566|
;;;307        for (i = 0; i < NumItems; i++) {
00021e  2400              MOVS     r4,#0
000220  e006              B        |L1.560|
                  |L1.546|
;;;308          ySize += _GetItemHeight(hObj, pObj, i);
000222  4622              MOV      r2,r4
000224  4639              MOV      r1,r7
000226  4648              MOV      r0,r9
000228  f7fffffe          BL       _GetItemHeight
00022c  4405              ADD      r5,r5,r0
00022e  1c64              ADDS     r4,r4,#1              ;307
                  |L1.560|
000230  4544              CMP      r4,r8                 ;307
000232  d3f6              BCC      |L1.546|
000234  e00e              B        |L1.596|
                  |L1.566|
;;;309        }
;;;310      } else {
;;;311        int ItemHeight;
;;;312        for (i = 0; i < NumItems; i++) {
000236  2400              MOVS     r4,#0
000238  e009              B        |L1.590|
                  |L1.570|
;;;313          ItemHeight = _GetItemHeight(hObj, pObj, i);
00023a  4622              MOV      r2,r4
00023c  4639              MOV      r1,r7
00023e  4648              MOV      r0,r9
000240  f7fffffe          BL       _GetItemHeight
000244  4606              MOV      r6,r0
;;;314          if (ItemHeight > ySize) {
000246  42ae              CMP      r6,r5
000248  dd00              BLE      |L1.588|
;;;315            ySize = ItemHeight;
00024a  4635              MOV      r5,r6
                  |L1.588|
00024c  1c64              ADDS     r4,r4,#1              ;312
                  |L1.590|
00024e  4544              CMP      r4,r8                 ;312
000250  d3f3              BCC      |L1.570|
;;;316          }
;;;317        }
;;;318      }
000252  bf00              NOP      
                  |L1.596|
;;;319      ySize += (_GetEffectSize(hObj, pObj) << 1);
000254  4639              MOV      r1,r7
000256  4648              MOV      r0,r9
000258  f7fffffe          BL       _GetEffectSize
00025c  eb050540          ADD      r5,r5,r0,LSL #1
;;;320      return ySize;
000260  4628              MOV      r0,r5
;;;321    }
000262  e8bd87f0          POP      {r4-r10,pc}
;;;322    
                          ENDP

                  _CalcWindowSizeX PROC
;;;326    */
;;;327    static int _CalcWindowSizeX(MENU_Handle hObj, MENU_Obj* pObj) {
000266  b570              PUSH     {r4-r6,lr}
000268  4606              MOV      r6,r0
00026a  460c              MOV      r4,r1
;;;328      int xSize = pObj->Width;
00026c  6e65              LDR      r5,[r4,#0x64]
;;;329      if (xSize == 0) {
00026e  b925              CBNZ     r5,|L1.634|
;;;330        xSize = _CalcMenuSizeX(hObj, pObj);
000270  4621              MOV      r1,r4
000272  4630              MOV      r0,r6
000274  f7fffffe          BL       _CalcMenuSizeX
000278  4605              MOV      r5,r0
                  |L1.634|
;;;331      }
;;;332      return xSize;
00027a  4628              MOV      r0,r5
;;;333    }
00027c  bd70              POP      {r4-r6,pc}
;;;334    
                          ENDP

                  _CalcWindowSizeY PROC
;;;338    */
;;;339    static int _CalcWindowSizeY(MENU_Handle hObj, MENU_Obj* pObj) {
00027e  b570              PUSH     {r4-r6,lr}
000280  4606              MOV      r6,r0
000282  460c              MOV      r4,r1
;;;340      int ySize = pObj->Height;
000284  6ea5              LDR      r5,[r4,#0x68]
;;;341      if (ySize == 0) {
000286  b925              CBNZ     r5,|L1.658|
;;;342        ySize = _CalcMenuSizeY(hObj, pObj);
000288  4621              MOV      r1,r4
00028a  4630              MOV      r0,r6
00028c  f7fffffe          BL       _CalcMenuSizeY
000290  4605              MOV      r5,r0
                  |L1.658|
;;;343      }
;;;344      return ySize;
000292  4628              MOV      r0,r5
;;;345    }
000294  bd70              POP      {r4-r6,pc}
;;;346    
                          ENDP

                  _GetItemFromPos PROC
;;;357    */
;;;358    static int _GetItemFromPos(MENU_Handle hObj, MENU_Obj* pObj, int x, int y) {
000296  e92d4fff          PUSH     {r0-r11,lr}
00029a  b083              SUB      sp,sp,#0xc
00029c  460c              MOV      r4,r1
00029e  4617              MOV      r7,r2
0002a0  4698              MOV      r8,r3
;;;359      int xSize, ySize, EffectSize, r = -1;
0002a2  f04f30ff          MOV      r0,#0xffffffff
0002a6  9002              STR      r0,[sp,#8]
;;;360      ySize = _CalcMenuSizeY(hObj, pObj);
0002a8  4621              MOV      r1,r4
0002aa  9803              LDR      r0,[sp,#0xc]
0002ac  f7fffffe          BL       _CalcMenuSizeY
0002b0  4682              MOV      r10,r0
;;;361      if ((pObj->Height) && (pObj->Height < ySize)) {
0002b2  6ea0              LDR      r0,[r4,#0x68]
0002b4  b120              CBZ      r0,|L1.704|
0002b6  6ea0              LDR      r0,[r4,#0x68]
0002b8  4550              CMP      r0,r10
0002ba  da01              BGE      |L1.704|
;;;362        ySize = pObj->Height;
0002bc  f8d4a068          LDR      r10,[r4,#0x68]
                  |L1.704|
;;;363      }
;;;364      xSize = _CalcMenuSizeX(hObj, pObj);
0002c0  4621              MOV      r1,r4
0002c2  9803              LDR      r0,[sp,#0xc]
0002c4  f7fffffe          BL       _CalcMenuSizeX
0002c8  4681              MOV      r9,r0
;;;365      if ((pObj->Width) && (pObj->Width < xSize)) {
0002ca  6e60              LDR      r0,[r4,#0x64]
0002cc  b120              CBZ      r0,|L1.728|
0002ce  6e60              LDR      r0,[r4,#0x64]
0002d0  4548              CMP      r0,r9
0002d2  da01              BGE      |L1.728|
;;;366        xSize = pObj->Width;
0002d4  f8d49064          LDR      r9,[r4,#0x64]
                  |L1.728|
;;;367      }
;;;368      EffectSize = _GetEffectSize(hObj, pObj);
0002d8  4621              MOV      r1,r4
0002da  9803              LDR      r0,[sp,#0xc]
0002dc  f7fffffe          BL       _GetEffectSize
0002e0  4606              MOV      r6,r0
;;;369      x     -= EffectSize;
0002e2  1bbf              SUBS     r7,r7,r6
;;;370      y     -= EffectSize;
0002e4  eba80806          SUB      r8,r8,r6
;;;371      xSize -= (EffectSize << 1);
0002e8  eba90946          SUB      r9,r9,r6,LSL #1
;;;372      ySize -= (EffectSize << 1);
0002ec  ebaa0a46          SUB      r10,r10,r6,LSL #1
;;;373      if ((x >= 0) && (y >= 0) && (x < xSize) && (y < ySize)) {
0002f0  2f00              CMP      r7,#0
0002f2  db38              BLT      |L1.870|
0002f4  f1b80f00          CMP      r8,#0
0002f8  db35              BLT      |L1.870|
0002fa  454f              CMP      r7,r9
0002fc  da33              BGE      |L1.870|
0002fe  45d0              CMP      r8,r10
000300  da31              BGE      |L1.870|
;;;374        unsigned i, NumItems = MENU__GetNumItems(pObj);
000302  4620              MOV      r0,r4
000304  f7fffffe          BL       MENU__GetNumItems
000308  9001              STR      r0,[sp,#4]
;;;375        if (pObj->Flags & MENU_SF_VERTICAL) {
00030a  f8b4005e          LDRH     r0,[r4,#0x5e]
00030e  f0100f01          TST      r0,#1
000312  d013              BEQ      |L1.828|
;;;376          int yPos = 0;
000314  f04f0b00          MOV      r11,#0
;;;377          for (i = 0; i < NumItems; i++) {
000318  2500              MOVS     r5,#0
00031a  e00a              B        |L1.818|
                  |L1.796|
;;;378            yPos += _GetItemHeight(hObj, pObj, i);
00031c  462a              MOV      r2,r5
00031e  4621              MOV      r1,r4
000320  9803              LDR      r0,[sp,#0xc]
000322  f7fffffe          BL       _GetItemHeight
000326  4483              ADD      r11,r11,r0
;;;379            if (y < yPos) {
000328  45d8              CMP      r8,r11
00032a  da01              BGE      |L1.816|
;;;380              r = i;
00032c  9502              STR      r5,[sp,#8]
;;;381              break;
00032e  e003              B        |L1.824|
                  |L1.816|
000330  1c6d              ADDS     r5,r5,#1              ;377
                  |L1.818|
000332  9801              LDR      r0,[sp,#4]            ;377
000334  4285              CMP      r5,r0                 ;377
000336  d3f1              BCC      |L1.796|
                  |L1.824|
000338  bf00              NOP      
;;;382            }
;;;383          }
;;;384        } else {
00033a  e013              B        |L1.868|
                  |L1.828|
;;;385          int xPos = 0;
00033c  f04f0b00          MOV      r11,#0
;;;386          for (i = 0; i < NumItems; i++) {
000340  2500              MOVS     r5,#0
000342  e00a              B        |L1.858|
                  |L1.836|
;;;387            xPos += _GetItemWidth(hObj, pObj, i);
000344  462a              MOV      r2,r5
000346  4621              MOV      r1,r4
000348  9803              LDR      r0,[sp,#0xc]
00034a  f7fffffe          BL       _GetItemWidth
00034e  4483              ADD      r11,r11,r0
;;;388            if (x < xPos) {
000350  455f              CMP      r7,r11
000352  da01              BGE      |L1.856|
;;;389              r = i;
000354  9502              STR      r5,[sp,#8]
;;;390              break;
000356  e003              B        |L1.864|
                  |L1.856|
000358  1c6d              ADDS     r5,r5,#1              ;386
                  |L1.858|
00035a  9801              LDR      r0,[sp,#4]            ;386
00035c  4285              CMP      r5,r0                 ;386
00035e  d3f1              BCC      |L1.836|
                  |L1.864|
000360  bf00              NOP      
;;;391            }
;;;392          }
;;;393        }
000362  bf00              NOP      
                  |L1.868|
;;;394      }
000364  bf00              NOP      
                  |L1.870|
;;;395      return r;
000366  9802              LDR      r0,[sp,#8]
;;;396    }
000368  b007              ADD      sp,sp,#0x1c
00036a  e8bd8ff0          POP      {r4-r11,pc}
;;;397    
                          ENDP

                  _GetItemPos PROC
;;;401    */
;;;402    static void _GetItemPos(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index, int* px, int* py) {
00036e  e92d5ff0          PUSH     {r4-r12,lr}
000372  4683              MOV      r11,r0
000374  4688              MOV      r8,r1
000376  4616              MOV      r6,r2
000378  461f              MOV      r7,r3
00037a  f8dd9028          LDR      r9,[sp,#0x28]
;;;403      int i, EffectSize;
;;;404      EffectSize = _GetEffectSize(hObj, pObj);
00037e  4641              MOV      r1,r8
000380  4658              MOV      r0,r11
000382  f7fffffe          BL       _GetEffectSize
000386  4605              MOV      r5,r0
;;;405      if (pObj->Flags & MENU_SF_VERTICAL) {
000388  f8b8005e          LDRH     r0,[r8,#0x5e]
00038c  f0100f01          TST      r0,#1
000390  d012              BEQ      |L1.952|
;;;406        int yPos = 0;
000392  f04f0a00          MOV      r10,#0
;;;407        for (i = 0; i < (int)Index; i++) {
000396  2400              MOVS     r4,#0
000398  e006              B        |L1.936|
                  |L1.922|
;;;408          yPos += _GetItemHeight(hObj, pObj, i);
00039a  4622              MOV      r2,r4
00039c  4641              MOV      r1,r8
00039e  4658              MOV      r0,r11
0003a0  f7fffffe          BL       _GetItemHeight
0003a4  4482              ADD      r10,r10,r0
0003a6  1c64              ADDS     r4,r4,#1              ;407
                  |L1.936|
0003a8  42b4              CMP      r4,r6                 ;407
0003aa  dbf6              BLT      |L1.922|
;;;409        }
;;;410        *px = EffectSize;
0003ac  603d              STR      r5,[r7,#0]
;;;411        *py = EffectSize + yPos;
0003ae  eb05000a          ADD      r0,r5,r10
0003b2  f8c90000          STR      r0,[r9,#0]
;;;412      } else {
0003b6  e012              B        |L1.990|
                  |L1.952|
;;;413        int xPos = 0;
0003b8  f04f0a00          MOV      r10,#0
;;;414        for (i = 0; i < (int)Index; i++) {
0003bc  2400              MOVS     r4,#0
0003be  e006              B        |L1.974|
                  |L1.960|
;;;415          xPos += _GetItemWidth(hObj, pObj, i);
0003c0  4622              MOV      r2,r4
0003c2  4641              MOV      r1,r8
0003c4  4658              MOV      r0,r11
0003c6  f7fffffe          BL       _GetItemWidth
0003ca  4482              ADD      r10,r10,r0
0003cc  1c64              ADDS     r4,r4,#1              ;414
                  |L1.974|
0003ce  42b4              CMP      r4,r6                 ;414
0003d0  dbf6              BLT      |L1.960|
;;;416        }
;;;417        *px = EffectSize + xPos;
0003d2  eb05000a          ADD      r0,r5,r10
0003d6  6038              STR      r0,[r7,#0]
;;;418        *py = EffectSize;
0003d8  f8c95000          STR      r5,[r9,#0]
;;;419      }
0003dc  bf00              NOP      
                  |L1.990|
;;;420    }
0003de  e8bd9ff0          POP      {r4-r12,pc}
;;;421    
                          ENDP

                  _SetCapture PROC
;;;425    */
;;;426    static void _SetCapture(MENU_Handle hObj, const MENU_Obj* pObj) {
0003e2  b570              PUSH     {r4-r6,lr}
0003e4  4605              MOV      r5,r0
0003e6  460c              MOV      r4,r1
;;;427      if (pObj->IsSubmenuActive == 0) {
0003e8  f8940060          LDRB     r0,[r4,#0x60]
0003ec  b938              CBNZ     r0,|L1.1022|
;;;428        if (WM_HasCaptured(hObj) == 0) {
0003ee  4628              MOV      r0,r5
0003f0  f7fffffe          BL       WM_HasCaptured
0003f4  b918              CBNZ     r0,|L1.1022|
;;;429          WM_SetCapture(hObj, 0);
0003f6  2100              MOVS     r1,#0
0003f8  4628              MOV      r0,r5
0003fa  f7fffffe          BL       WM_SetCapture
                  |L1.1022|
;;;430        }
;;;431      }
;;;432    }
0003fe  bd70              POP      {r4-r6,pc}
;;;433    
                          ENDP

                  _ReleaseCapture PROC
;;;437    */
;;;438    static void _ReleaseCapture(MENU_Handle hObj, const MENU_Obj* pObj) {
000400  b570              PUSH     {r4-r6,lr}
000402  4605              MOV      r5,r0
000404  460c              MOV      r4,r1
;;;439      if (WM_HasCaptured(hObj)) {
000406  4628              MOV      r0,r5
000408  f7fffffe          BL       WM_HasCaptured
00040c  b158              CBZ      r0,|L1.1062|
;;;440        if (_IsTopLevelMenu(hObj, pObj) && !(pObj->Flags & MENU_SF_POPUP)) {
00040e  4621              MOV      r1,r4
000410  4628              MOV      r0,r5
000412  f7fffffe          BL       _IsTopLevelMenu
000416  b130              CBZ      r0,|L1.1062|
000418  f8b4005e          LDRH     r0,[r4,#0x5e]
00041c  f0100f80          TST      r0,#0x80
000420  d101              BNE      |L1.1062|
;;;441          WM_ReleaseCapture();
000422  f7fffffe          BL       WM_ReleaseCapture
                  |L1.1062|
;;;442        }
;;;443      }
;;;444    }
000426  bd70              POP      {r4-r6,pc}
;;;445    
                          ENDP

                  MENU__InvalidateItem PROC
;;;1034   */
;;;1035   void MENU__InvalidateItem(MENU_Handle hObj, const MENU_Obj* pObj, unsigned Index) {
000428  b570              PUSH     {r4-r6,lr}
00042a  4606              MOV      r6,r0
00042c  460c              MOV      r4,r1
00042e  4615              MOV      r5,r2
;;;1036     GUI_USE_PARA(pObj);
000430  bf00              NOP      
;;;1037     GUI_USE_PARA(Index);
000432  bf00              NOP      
;;;1038     WM_InvalidateWindow(hObj);  /* Can be optimized, no need to invalidate all items */
000434  4630              MOV      r0,r6
000436  f7fffffe          BL       WM_InvalidateWindow
;;;1039   }
00043a  bd70              POP      {r4-r6,pc}
;;;1040   
                          ENDP

                  _CloseSubmenu PROC
;;;449    */
;;;450    static void _CloseSubmenu(MENU_Handle hObj, MENU_Obj* pObj) {
00043c  b570              PUSH     {r4-r6,lr}
00043e  4606              MOV      r6,r0
000440  460c              MOV      r4,r1
;;;451      if (pObj->Flags & MENU_SF_ACTIVE) {
000442  f8b4005e          LDRH     r0,[r4,#0x5e]
000446  f0100f40          TST      r0,#0x40
00044a  d020              BEQ      |L1.1166|
;;;452        if (pObj->IsSubmenuActive) {
00044c  f8940060          LDRB     r0,[r4,#0x60]
000450  b1e8              CBZ      r0,|L1.1166|
;;;453          MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, pObj->Sel);
000452  f1040058          ADD      r0,r4,#0x58
000456  6ee1              LDR      r1,[r4,#0x6c]
000458  f7fffffe          BL       GUI_ARRAY_GetpItem
00045c  4605              MOV      r5,r0
;;;454          /* Inform submenu about its deactivation and detach it */
;;;455          MENU__SendMenuMessage(hObj, pItem->hSubmenu, MENU_ON_CLOSE, 0);
00045e  f9b51000          LDRSH    r1,[r5,#0]
000462  2300              MOVS     r3,#0
000464  2204              MOVS     r2,#4
000466  4630              MOV      r0,r6
000468  f7fffffe          BL       MENU__SendMenuMessage
;;;456          WM_DetachWindow(pItem->hSubmenu);
00046c  f9b50000          LDRSH    r0,[r5,#0]
000470  f7fffffe          BL       WM_DetachWindow
;;;457          pObj->IsSubmenuActive = 0;
000474  2000              MOVS     r0,#0
000476  f8840060          STRB     r0,[r4,#0x60]
;;;458          /*
;;;459           * Keep capture in menu widget. The capture may only released
;;;460           * by clicking outside the menu or when mouse moved out.
;;;461           * And it may only released from a top level menu.
;;;462           */
;;;463          _SetCapture(hObj, pObj);
00047a  4621              MOV      r1,r4
00047c  4630              MOV      r0,r6
00047e  f7fffffe          BL       _SetCapture
;;;464          /* Invalidate menu item. This is needed because the appearance may have changed */
;;;465          MENU__InvalidateItem(hObj, pObj, pObj->Sel);
000482  4621              MOV      r1,r4
000484  4630              MOV      r0,r6
000486  6ee2              LDR      r2,[r4,#0x6c]
000488  f7fffffe          BL       MENU__InvalidateItem
;;;466        }
00048c  bf00              NOP      
                  |L1.1166|
;;;467      }
;;;468    }
00048e  bd70              POP      {r4-r6,pc}
;;;469    
                          ENDP

                  MENU_SetOwner PROC
;;;1162   */
;;;1163   void MENU_SetOwner(MENU_Handle hObj, WM_HWIN hOwner) {
000490  b570              PUSH     {r4-r6,lr}
000492  4604              MOV      r4,r0
000494  460d              MOV      r5,r1
;;;1164     if (hObj) {
000496  b15c              CBZ      r4,|L1.1200|
;;;1165       MENU_Obj* pObj;
;;;1166       WM_LOCK();
000498  f7fffffe          BL       GUI_Lock
;;;1167       pObj = MENU_H2P(hObj);
00049c  4620              MOV      r0,r4
00049e  f7fffffe          BL       GUI_ALLOC_h2p
0004a2  4606              MOV      r6,r0
;;;1168       if (pObj) {
0004a4  b10e              CBZ      r6,|L1.1194|
;;;1169         pObj->hOwner = hOwner;
0004a6  f8a6505c          STRH     r5,[r6,#0x5c]
                  |L1.1194|
;;;1170       }
;;;1171       WM_UNLOCK();
0004aa  f7fffffe          BL       GUI_Unlock
;;;1172     }
0004ae  bf00              NOP      
                  |L1.1200|
;;;1173   }
0004b0  bd70              POP      {r4-r6,pc}
;;;1174   
                          ENDP

                  _OpenSubmenu PROC
;;;473    */
;;;474    static void _OpenSubmenu(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0004b2  e92d4ffe          PUSH     {r1-r11,lr}
0004b6  4606              MOV      r6,r0
0004b8  460c              MOV      r4,r1
0004ba  4617              MOV      r7,r2
;;;475      if (pObj->Flags & MENU_SF_ACTIVE) {
0004bc  f8b4005e          LDRH     r0,[r4,#0x5e]
0004c0  f0100f40          TST      r0,#0x40
0004c4  d07e              BEQ      |L1.1476|
;;;476        MENU_ITEM* pItem;
;;;477        char PrevActiveSubmenu;
;;;478        PrevActiveSubmenu = pObj->IsSubmenuActive;
0004c6  f8949060          LDRB     r9,[r4,#0x60]
;;;479        /* Close previous submenu (if needed) */
;;;480        _CloseSubmenu(hObj, pObj);
0004ca  4621              MOV      r1,r4
0004cc  4630              MOV      r0,r6
0004ce  f7fffffe          BL       _CloseSubmenu
;;;481        pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0004d2  4639              MOV      r1,r7
0004d4  f1040058          ADD      r0,r4,#0x58
0004d8  f7fffffe          BL       GUI_ARRAY_GetpItem
0004dc  4605              MOV      r5,r0
;;;482        if (pItem->hSubmenu) {
0004de  8828              LDRH     r0,[r5,#0]
0004e0  2800              CMP      r0,#0
0004e2  d07e              BEQ      |L1.1506|
;;;483          if ((pItem->Flags & MENU_IF_DISABLED) == 0) {
0004e4  88a8              LDRH     r0,[r5,#4]
0004e6  f0100f01          TST      r0,#1
0004ea  d17a              BNE      |L1.1506|
;;;484            int x, y, EffectSize;
;;;485            /* Calculate position of submenu */
;;;486            EffectSize = _GetEffectSize(hObj, pObj);
0004ec  4621              MOV      r1,r4
0004ee  4630              MOV      r0,r6
0004f0  f7fffffe          BL       _GetEffectSize
0004f4  4680              MOV      r8,r0
;;;487            _GetItemPos(hObj, pObj, Index, &x, &y);
0004f6  a801              ADD      r0,sp,#4
0004f8  ab02              ADD      r3,sp,#8
0004fa  463a              MOV      r2,r7
0004fc  4621              MOV      r1,r4
0004fe  9000              STR      r0,[sp,#0]
000500  4630              MOV      r0,r6
000502  f7fffffe          BL       _GetItemPos
;;;488            if (pObj->Flags & MENU_SF_VERTICAL) {
000506  f8b4005e          LDRH     r0,[r4,#0x5e]
00050a  f0100f01          TST      r0,#1
00050e  d012              BEQ      |L1.1334|
;;;489              x += _CalcMenuSizeX(hObj, pObj) - (_GetEffectSize(hObj, pObj) << 1);
000510  4621              MOV      r1,r4
000512  4630              MOV      r0,r6
000514  f7fffffe          BL       _CalcMenuSizeX
000518  4682              MOV      r10,r0
00051a  4621              MOV      r1,r4
00051c  4630              MOV      r0,r6
00051e  f7fffffe          BL       _GetEffectSize
000522  ebaa0040          SUB      r0,r10,r0,LSL #1
000526  9902              LDR      r1,[sp,#8]
000528  4408              ADD      r0,r0,r1
00052a  9002              STR      r0,[sp,#8]
;;;490              y -= EffectSize;
00052c  9801              LDR      r0,[sp,#4]
00052e  eba00008          SUB      r0,r0,r8
000532  9001              STR      r0,[sp,#4]
000534  e011              B        |L1.1370|
                  |L1.1334|
;;;491            } else {
;;;492              y += _CalcMenuSizeY(hObj, pObj) - (_GetEffectSize(hObj, pObj) << 1);
000536  4621              MOV      r1,r4
000538  4630              MOV      r0,r6
00053a  f7fffffe          BL       _CalcMenuSizeY
00053e  4682              MOV      r10,r0
000540  4621              MOV      r1,r4
000542  4630              MOV      r0,r6
000544  f7fffffe          BL       _GetEffectSize
000548  ebaa0040          SUB      r0,r10,r0,LSL #1
00054c  9901              LDR      r1,[sp,#4]
00054e  4408              ADD      r0,r0,r1
000550  9001              STR      r0,[sp,#4]
;;;493              x -= EffectSize;
000552  9802              LDR      r0,[sp,#8]
000554  eba00008          SUB      r0,r0,r8
000558  9002              STR      r0,[sp,#8]
                  |L1.1370|
;;;494            }
;;;495            x += WM_GetWindowOrgX(hObj);
00055a  4630              MOV      r0,r6
00055c  f7fffffe          BL       WM_GetWindowOrgX
000560  9902              LDR      r1,[sp,#8]
000562  4408              ADD      r0,r0,r1
000564  9002              STR      r0,[sp,#8]
;;;496            y += WM_GetWindowOrgY(hObj);
000566  4630              MOV      r0,r6
000568  f7fffffe          BL       WM_GetWindowOrgY
00056c  9901              LDR      r1,[sp,#4]
00056e  4408              ADD      r0,r0,r1
000570  9001              STR      r0,[sp,#4]
;;;497            /*
;;;498             * Notify owner window when for the first time open a menu (when no
;;;499             * other submenu was open), so it can initialize the menu items.
;;;500             */
;;;501            if (PrevActiveSubmenu == 0) {
000572  f1b90f00          CMP      r9,#0
000576  d10b              BNE      |L1.1424|
;;;502              if (_IsTopLevelMenu(hObj, pObj)) {
000578  4621              MOV      r1,r4
00057a  4630              MOV      r0,r6
00057c  f7fffffe          BL       _IsTopLevelMenu
000580  b130              CBZ      r0,|L1.1424|
;;;503                MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_INITMENU, 0);
000582  f9b4105c          LDRSH    r1,[r4,#0x5c]
000586  2300              MOVS     r3,#0
000588  2201              MOVS     r2,#1
00058a  4630              MOV      r0,r6
00058c  f7fffffe          BL       MENU__SendMenuMessage
                  |L1.1424|
;;;504              }
;;;505            }
;;;506            /* Notify owner window when a submenu opens, so it can initialize the menu items. */
;;;507            MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_INITSUBMENU, pItem->Id);
000590  886b              LDRH     r3,[r5,#2]
000592  f9b4105c          LDRSH    r1,[r4,#0x5c]
000596  2202              MOVS     r2,#2
000598  4630              MOV      r0,r6
00059a  f7fffffe          BL       MENU__SendMenuMessage
;;;508            /* Set active menu as owner of submenu. */
;;;509            MENU_SetOwner(pItem->hSubmenu, hObj);
00059e  f9b50000          LDRSH    r0,[r5,#0]
0005a2  4631              MOV      r1,r6
0005a4  f7fffffe          BL       MENU_SetOwner
;;;510            /* Attach submenu and inform it about its activation. */
;;;511            WM_AttachWindowAt(pItem->hSubmenu, WM_HBKWIN, x, y);
0005a8  f7fffffe          BL       WM_GetDesktopWindow
0005ac  4682              MOV      r10,r0
0005ae  f9b50000          LDRSH    r0,[r5,#0]
0005b2  4651              MOV      r1,r10
0005b4  e9dd3201          LDRD     r3,r2,[sp,#4]
0005b8  f7fffffe          BL       WM_AttachWindowAt
;;;512            MENU__SendMenuMessage(hObj, pItem->hSubmenu, MENU_ON_OPEN, 0);
0005bc  f9b51000          LDRSH    r1,[r5,#0]
0005c0  2300              MOVS     r3,#0
0005c2  e001              B        |L1.1480|
                  |L1.1476|
0005c4  e00e              B        |L1.1508|
0005c6  e00c              B        |L1.1506|
                  |L1.1480|
0005c8  2203              MOVS     r2,#3
0005ca  4630              MOV      r0,r6
0005cc  f7fffffe          BL       MENU__SendMenuMessage
;;;513            pObj->IsSubmenuActive = 1;
0005d0  2001              MOVS     r0,#1
0005d2  f8840060          STRB     r0,[r4,#0x60]
;;;514            /* Invalidate menu item. This is needed because the appearance may have changed. */
;;;515            MENU__InvalidateItem(hObj, pObj, Index);
0005d6  463a              MOV      r2,r7
0005d8  4621              MOV      r1,r4
0005da  4630              MOV      r0,r6
0005dc  f7fffffe          BL       MENU__InvalidateItem
;;;516          }
0005e0  bf00              NOP      
                  |L1.1506|
;;;517        }
;;;518      }
0005e2  bf00              NOP      
                  |L1.1508|
;;;519    }
0005e4  e8bd8ffe          POP      {r1-r11,pc}
;;;520    
                          ENDP

                  _ClosePopup PROC
;;;524    */
;;;525    static void _ClosePopup(MENU_Handle hObj, MENU_Obj* pObj) {
0005e8  b570              PUSH     {r4-r6,lr}
0005ea  4605              MOV      r5,r0
0005ec  460c              MOV      r4,r1
;;;526      if (pObj->Flags & MENU_SF_POPUP) {
0005ee  f8b4005e          LDRH     r0,[r4,#0x5e]
0005f2  f0100f80          TST      r0,#0x80
0005f6  d00a              BEQ      |L1.1550|
;;;527        pObj->Flags &= ~(MENU_SF_POPUP);
0005f8  f8b4005e          LDRH     r0,[r4,#0x5e]
0005fc  f0200080          BIC      r0,r0,#0x80
000600  f8a4005e          STRH     r0,[r4,#0x5e]
;;;528        WM_DetachWindow(hObj);
000604  4628              MOV      r0,r5
000606  f7fffffe          BL       WM_DetachWindow
;;;529        WM_ReleaseCapture();
00060a  f7fffffe          BL       WM_ReleaseCapture
                  |L1.1550|
;;;530      }
;;;531    }
00060e  bd70              POP      {r4-r6,pc}
;;;532    
                          ENDP

                  _SetSelection PROC
;;;536    */
;;;537    static void _SetSelection(MENU_Handle hObj, MENU_Obj* pObj, int Index) {
000610  b570              PUSH     {r4-r6,lr}
000612  4606              MOV      r6,r0
000614  460c              MOV      r4,r1
000616  4615              MOV      r5,r2
;;;538      if (Index != pObj->Sel) {
000618  6ee0              LDR      r0,[r4,#0x6c]
00061a  42a8              CMP      r0,r5
00061c  d00a              BEQ      |L1.1588|
;;;539        MENU__InvalidateItem(hObj, pObj, pObj->Sel); /* Invalidate previous selection */
00061e  4621              MOV      r1,r4
000620  4630              MOV      r0,r6
000622  6ee2              LDR      r2,[r4,#0x6c]
000624  f7fffffe          BL       MENU__InvalidateItem
;;;540        MENU__InvalidateItem(hObj, pObj, Index);     /* Invalidate new selection */
000628  462a              MOV      r2,r5
00062a  4621              MOV      r1,r4
00062c  4630              MOV      r0,r6
00062e  f7fffffe          BL       MENU__InvalidateItem
;;;541        pObj->Sel = Index;
000632  66e5              STR      r5,[r4,#0x6c]
                  |L1.1588|
;;;542      }
;;;543    }
000634  bd70              POP      {r4-r6,pc}
;;;544    
                          ENDP

                  _SelectItem PROC
;;;548    */
;;;549    static void _SelectItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
000636  b570              PUSH     {r4-r6,lr}
000638  4606              MOV      r6,r0
00063a  460c              MOV      r4,r1
00063c  4615              MOV      r5,r2
;;;550      if (pObj->Sel != (int)Index) {
00063e  6ee0              LDR      r0,[r4,#0x6c]
000640  42a8              CMP      r0,r5
000642  d00d              BEQ      |L1.1632|
;;;551        _SetCapture(hObj, pObj);
000644  4621              MOV      r1,r4
000646  4630              MOV      r0,r6
000648  f7fffffe          BL       _SetCapture
;;;552        _OpenSubmenu(hObj, pObj, Index);
00064c  462a              MOV      r2,r5
00064e  4621              MOV      r1,r4
000650  4630              MOV      r0,r6
000652  f7fffffe          BL       _OpenSubmenu
;;;553        _SetSelection(hObj, pObj, Index);
000656  462a              MOV      r2,r5
000658  4621              MOV      r1,r4
00065a  4630              MOV      r0,r6
00065c  f7fffffe          BL       _SetSelection
                  |L1.1632|
;;;554      }
;;;555    }
000660  bd70              POP      {r4-r6,pc}
;;;556    
                          ENDP

                  _DeselectItem PROC
;;;560    */
;;;561    static void _DeselectItem(MENU_Handle hObj, MENU_Obj* pObj) {
000662  b570              PUSH     {r4-r6,lr}
000664  4605              MOV      r5,r0
000666  460c              MOV      r4,r1
;;;562      if (pObj->IsSubmenuActive == 0) {
000668  f8940060          LDRB     r0,[r4,#0x60]
00066c  b948              CBNZ     r0,|L1.1666|
;;;563        _SetSelection(hObj, pObj, -1);
00066e  f04f32ff          MOV      r2,#0xffffffff
000672  4621              MOV      r1,r4
000674  4628              MOV      r0,r5
000676  f7fffffe          BL       _SetSelection
;;;564        _ReleaseCapture(hObj, pObj);
00067a  4621              MOV      r1,r4
00067c  4628              MOV      r0,r5
00067e  f7fffffe          BL       _ReleaseCapture
                  |L1.1666|
;;;565      }
;;;566    }
000682  bd70              POP      {r4-r6,pc}
;;;567    
                          ENDP

                  _ActivateItem PROC
;;;571    */
;;;572    static void _ActivateItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
000684  e92d41f0          PUSH     {r4-r8,lr}
000688  4607              MOV      r7,r0
00068a  460c              MOV      r4,r1
00068c  4616              MOV      r6,r2
;;;573      MENU_ITEM* pItem;
;;;574      pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
00068e  4631              MOV      r1,r6
000690  f1040058          ADD      r0,r4,#0x58
000694  f7fffffe          BL       GUI_ARRAY_GetpItem
000698  4605              MOV      r5,r0
;;;575      if (pItem->hSubmenu == 0) {
00069a  8828              LDRH     r0,[r5,#0]
00069c  b970              CBNZ     r0,|L1.1724|
;;;576        if ((pItem->Flags & (MENU_IF_DISABLED | MENU_IF_SEPARATOR)) == 0) {
00069e  88a8              LDRH     r0,[r5,#4]
0006a0  f0100f03          TST      r0,#3
0006a4  d10a              BNE      |L1.1724|
;;;577          _ClosePopup(hObj, pObj);
0006a6  4621              MOV      r1,r4
0006a8  4638              MOV      r0,r7
0006aa  f7fffffe          BL       _ClosePopup
;;;578          /* Send item select message to owner. */
;;;579          MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_ITEMSELECT, pItem->Id);
0006ae  886b              LDRH     r3,[r5,#2]
0006b0  f9b4105c          LDRSH    r1,[r4,#0x5c]
0006b4  2200              MOVS     r2,#0
0006b6  4638              MOV      r0,r7
0006b8  f7fffffe          BL       MENU__SendMenuMessage
                  |L1.1724|
;;;580        }
;;;581      }
;;;582    }
0006bc  e8bd81f0          POP      {r4-r8,pc}
;;;583    
                          ENDP

                  _ActivateMenu PROC
;;;587    */
;;;588    static void _ActivateMenu(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0006c0  e92d41f0          PUSH     {r4-r8,lr}
0006c4  4607              MOV      r7,r0
0006c6  460c              MOV      r4,r1
0006c8  4615              MOV      r5,r2
;;;589      if ((pObj->Flags & MENU_SF_OPEN_ON_POINTEROVER) == 0) {
0006ca  f8b4005e          LDRH     r0,[r4,#0x5e]
0006ce  f0100f02          TST      r0,#2
0006d2  d134              BNE      |L1.1854|
;;;590        MENU_ITEM* pItem;
;;;591        pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0006d4  4629              MOV      r1,r5
0006d6  f1040058          ADD      r0,r4,#0x58
0006da  f7fffffe          BL       GUI_ARRAY_GetpItem
0006de  4606              MOV      r6,r0
;;;592        if (pItem->hSubmenu) {
0006e0  8830              LDRH     r0,[r6,#0]
0006e2  b358              CBZ      r0,|L1.1852|
;;;593          if ((pItem->Flags & MENU_IF_DISABLED) == 0) {
0006e4  88b0              LDRH     r0,[r6,#4]
0006e6  f0100f01          TST      r0,#1
0006ea  d127              BNE      |L1.1852|
;;;594            if ((pObj->Flags & MENU_SF_ACTIVE) == 0) {
0006ec  f8b4005e          LDRH     r0,[r4,#0x5e]
0006f0  f0100f40          TST      r0,#0x40
0006f4  d110              BNE      |L1.1816|
;;;595              pObj->Flags |= MENU_SF_ACTIVE;
0006f6  f8b4005e          LDRH     r0,[r4,#0x5e]
0006fa  f0400040          ORR      r0,r0,#0x40
0006fe  f8a4005e          STRH     r0,[r4,#0x5e]
;;;596              _OpenSubmenu(hObj, pObj, Index);
000702  462a              MOV      r2,r5
000704  4621              MOV      r1,r4
000706  4638              MOV      r0,r7
000708  f7fffffe          BL       _OpenSubmenu
;;;597              _SetSelection(hObj, pObj, Index);
00070c  462a              MOV      r2,r5
00070e  4621              MOV      r1,r4
000710  4638              MOV      r0,r7
000712  f7fffffe          BL       _SetSelection
000716  e011              B        |L1.1852|
                  |L1.1816|
;;;598            } else if (pObj->Flags & MENU_SF_CLOSE_ON_SECOND_CLICK) {
000718  f8b4005e          LDRH     r0,[r4,#0x5e]
00071c  f0100f04          TST      r0,#4
000720  d00c              BEQ      |L1.1852|
;;;599              if ((int)Index == pObj->Sel) {
000722  6ee0              LDR      r0,[r4,#0x6c]
000724  42a8              CMP      r0,r5
000726  d109              BNE      |L1.1852|
;;;600                _CloseSubmenu(hObj, pObj);
000728  4621              MOV      r1,r4
00072a  4638              MOV      r0,r7
00072c  f7fffffe          BL       _CloseSubmenu
;;;601                pObj->Flags &= ~MENU_SF_ACTIVE;
000730  f8b4005e          LDRH     r0,[r4,#0x5e]
000734  f0200040          BIC      r0,r0,#0x40
000738  f8a4005e          STRH     r0,[r4,#0x5e]
                  |L1.1852|
;;;602              }
;;;603            }
;;;604          }
;;;605        }
;;;606      }
00073c  bf00              NOP      
                  |L1.1854|
;;;607    }
00073e  e8bd81f0          POP      {r4-r8,pc}
;;;608    
                          ENDP

                  _DeactivateMenu PROC
;;;612    */
;;;613    static void _DeactivateMenu(MENU_Handle hObj, MENU_Obj* pObj) {
000742  b570              PUSH     {r4-r6,lr}
000744  4605              MOV      r5,r0
000746  460c              MOV      r4,r1
;;;614      _CloseSubmenu(hObj, pObj);
000748  4621              MOV      r1,r4
00074a  4628              MOV      r0,r5
00074c  f7fffffe          BL       _CloseSubmenu
;;;615      if ((pObj->Flags & MENU_SF_OPEN_ON_POINTEROVER) == 0) {
000750  f8b4005e          LDRH     r0,[r4,#0x5e]
000754  f0100f02          TST      r0,#2
000758  d105              BNE      |L1.1894|
;;;616        pObj->Flags &= ~MENU_SF_ACTIVE;
00075a  f8b4005e          LDRH     r0,[r4,#0x5e]
00075e  f0200040          BIC      r0,r0,#0x40
000762  f8a4005e          STRH     r0,[r4,#0x5e]
                  |L1.1894|
;;;617      }
;;;618    }
000766  bd70              POP      {r4-r6,pc}
;;;619    
                          ENDP

                  _ForwardMouseOverMsg PROC
;;;623    */
;;;624    static int _ForwardMouseOverMsg(MENU_Handle hObj, MENU_Obj* pObj, int x, int y) {
000768  b510              PUSH     {r4,lr}
00076a  4604              MOV      r4,r0
;;;625    #if (GUI_SUPPORT_MOUSE)
;;;626      if ((pObj->IsSubmenuActive == 0) && !(pObj->Flags & MENU_SF_POPUP)) {
;;;627        if (_IsTopLevelMenu(hObj, pObj)) {
;;;628          WM_HWIN hBelow;
;;;629          x += WM_GetWindowOrgX(hObj);
;;;630          y += WM_GetWindowOrgY(hObj);
;;;631          hBelow = WM_Screen2hWin(x, y);
;;;632          if (hBelow && (hBelow != hObj)) {
;;;633            WM_MESSAGE Msg;
;;;634            GUI_PID_STATE State;
;;;635            x -= WM_GetWindowOrgX(hBelow);
;;;636            y -= WM_GetWindowOrgY(hBelow);
;;;637            State.Pressed = 0;
;;;638            State.x = x;
;;;639            State.y = y;
;;;640            Msg.Data.p = &State;
;;;641            Msg.MsgId = WM_MOUSEOVER;
;;;642            WM__SendMessage(hBelow, &Msg);
;;;643            return 1;
;;;644          }
;;;645        }
;;;646      }
;;;647    #endif
;;;648      return 0;
00076c  2000              MOVS     r0,#0
;;;649    }
00076e  bd10              POP      {r4,pc}
;;;650    
                          ENDP

                  _HandlePID PROC
;;;658    */
;;;659    static char _HandlePID(MENU_Handle hObj, MENU_Obj* pObj, int x, int y, int Pressed) {
000770  e92d47f0          PUSH     {r4-r10,lr}
000774  b086              SUB      sp,sp,#0x18
000776  4681              MOV      r9,r0
000778  460f              MOV      r7,r1
00077a  4615              MOV      r5,r2
00077c  461e              MOV      r6,r3
00077e  9c0e              LDR      r4,[sp,#0x38]
;;;660      GUI_PID_STATE PrevState;
;;;661      char XYInWidget = 0;
000780  f04f0a00          MOV      r10,#0
;;;662      WM_PID__GetPrevState(&PrevState);
000784  a803              ADD      r0,sp,#0xc
000786  f7fffffe          BL       WM_PID__GetPrevState
;;;663      /*
;;;664       * Check if coordinates are inside the widget.
;;;665       */
;;;666      if ((x >= 0) && (y >= 0)) {
00078a  2d00              CMP      r5,#0
00078c  db10              BLT      |L1.1968|
00078e  2e00              CMP      r6,#0
000790  db0e              BLT      |L1.1968|
;;;667        GUI_RECT r;
;;;668        WM__GetClientRectWin(&pObj->Widget.Win, &r);
000792  a901              ADD      r1,sp,#4
000794  4638              MOV      r0,r7
000796  f7fffffe          BL       WM__GetClientRectWin
;;;669        if ((x <= r.x1) && (y <= r.y1)) {
00079a  f9bd0008          LDRSH    r0,[sp,#8]
00079e  42a8              CMP      r0,r5
0007a0  db05              BLT      |L1.1966|
0007a2  f9bd000a          LDRSH    r0,[sp,#0xa]
0007a6  42b0              CMP      r0,r6
0007a8  db01              BLT      |L1.1966|
;;;670          XYInWidget = 1;
0007aa  f04f0a01          MOV      r10,#1
                  |L1.1966|
;;;671        }
;;;672      }
0007ae  bf00              NOP      
                  |L1.1968|
;;;673    
;;;674      if (XYInWidget) {
0007b0  f1ba0f00          CMP      r10,#0
0007b4  d050              BEQ      |L1.2136|
;;;675        int ItemIndex;
;;;676        ItemIndex = _GetItemFromPos(hObj, pObj, x, y);
0007b6  4633              MOV      r3,r6
0007b8  462a              MOV      r2,r5
0007ba  4639              MOV      r1,r7
0007bc  4648              MOV      r0,r9
0007be  f7fffffe          BL       _GetItemFromPos
0007c2  4680              MOV      r8,r0
;;;677        /* 
;;;678         * Handle PID when coordinates are inside the widget.
;;;679         */
;;;680        if (ItemIndex >= 0) {
0007c4  f1b80f00          CMP      r8,#0
0007c8  db2e              BLT      |L1.2088|
;;;681          /* 
;;;682           * Coordinates are inside the menu.
;;;683           */
;;;684          if (Pressed == 1) {
0007ca  2c01              CMP      r4,#1
0007cc  d10d              BNE      |L1.2026|
;;;685            if (PrevState.Pressed == 0) {  /* Clicked */
0007ce  f89d0014          LDRB     r0,[sp,#0x14]
0007d2  b920              CBNZ     r0,|L1.2014|
;;;686              _ActivateMenu(hObj, pObj, ItemIndex);
0007d4  4642              MOV      r2,r8
0007d6  4639              MOV      r1,r7
0007d8  4648              MOV      r0,r9
0007da  f7fffffe          BL       _ActivateMenu
                  |L1.2014|
;;;687            }
;;;688            _SelectItem(hObj, pObj, ItemIndex);
0007de  4642              MOV      r2,r8
0007e0  4639              MOV      r1,r7
0007e2  4648              MOV      r0,r9
0007e4  f7fffffe          BL       _SelectItem
0007e8  e032              B        |L1.2128|
                  |L1.2026|
;;;689          } else if ((Pressed == 0) && (PrevState.Pressed == 1)) {  /* Released */
0007ea  b94c              CBNZ     r4,|L1.2048|
0007ec  f89d0014          LDRB     r0,[sp,#0x14]
0007f0  2801              CMP      r0,#1
0007f2  d105              BNE      |L1.2048|
;;;690            _ActivateItem(hObj, pObj, ItemIndex);
0007f4  4642              MOV      r2,r8
0007f6  4639              MOV      r1,r7
0007f8  4648              MOV      r0,r9
0007fa  f7fffffe          BL       _ActivateItem
0007fe  e027              B        |L1.2128|
                  |L1.2048|
;;;691          } else if (Pressed < 0) {  /* Mouse moved */
000800  2c00              CMP      r4,#0
000802  da25              BGE      |L1.2128|
;;;692            if (_ForwardMouseOverMsg(hObj, pObj, x, y) == 0) {
000804  4633              MOV      r3,r6
000806  462a              MOV      r2,r5
000808  4639              MOV      r1,r7
00080a  4648              MOV      r0,r9
00080c  f7fffffe          BL       _ForwardMouseOverMsg
000810  b928              CBNZ     r0,|L1.2078|
;;;693              _SelectItem(hObj, pObj, ItemIndex);
000812  4642              MOV      r2,r8
000814  4639              MOV      r1,r7
000816  4648              MOV      r0,r9
000818  f7fffffe          BL       _SelectItem
00081c  e018              B        |L1.2128|
                  |L1.2078|
;;;694            } else {
;;;695              _DeselectItem(hObj, pObj);
00081e  4639              MOV      r1,r7
000820  4648              MOV      r0,r9
000822  f7fffffe          BL       _DeselectItem
000826  e013              B        |L1.2128|
                  |L1.2088|
;;;696            }
;;;697          }
;;;698        } else {
;;;699          /* 
;;;700           * Coordinates are outside the menu but inside the widget.
;;;701           */
;;;702          if (Pressed == 1) {
000828  2c01              CMP      r4,#1
00082a  d10b              BNE      |L1.2116|
;;;703            if (PrevState.Pressed == 0) {  /* Clicked */
00082c  f89d0014          LDRB     r0,[sp,#0x14]
000830  b918              CBNZ     r0,|L1.2106|
;;;704              /* 
;;;705               * User has clicked outside the menu. Close the active submenu.
;;;706               * The widget itself must be closed (if needed) by the owner.
;;;707               */
;;;708              _DeactivateMenu(hObj, pObj);
000832  4639              MOV      r1,r7
000834  4648              MOV      r0,r9
000836  f7fffffe          BL       _DeactivateMenu
                  |L1.2106|
;;;709            }
;;;710            _DeselectItem(hObj, pObj);
00083a  4639              MOV      r1,r7
00083c  4648              MOV      r0,r9
00083e  f7fffffe          BL       _DeselectItem
000842  e005              B        |L1.2128|
                  |L1.2116|
;;;711          } else if (Pressed < 0) {  /* Moved out or mouse moved */
000844  2c00              CMP      r4,#0
000846  da03              BGE      |L1.2128|
;;;712            _DeselectItem(hObj, pObj);
000848  4639              MOV      r1,r7
00084a  4648              MOV      r0,r9
00084c  f7fffffe          BL       _DeselectItem
                  |L1.2128|
;;;713          }
;;;714        }
;;;715        return 0;
000850  2000              MOVS     r0,#0
                  |L1.2130|
;;;716      } else {
;;;717        /* 
;;;718         * Handle PID when coordinates are outside the widget.
;;;719         */
;;;720        if ((Pressed == 1) && (PrevState.Pressed == 0)) {
;;;721          /* 
;;;722           * User has clicked outside the menu. Close the active submenu.
;;;723           * The widget itself must be closed (if needed) by the owner.
;;;724           */
;;;725          _DeactivateMenu(hObj, pObj);
;;;726          _ClosePopup(hObj, pObj);
;;;727        }
;;;728        _DeselectItem(hObj, pObj);
;;;729        _ForwardMouseOverMsg(hObj, pObj, x, y);
;;;730      }
;;;731      return 1;   /* Coordinates are not in widget, we need to forward PID message to owner */
;;;732    }
000852  b006              ADD      sp,sp,#0x18
000854  e8bd87f0          POP      {r4-r10,pc}
                  |L1.2136|
000858  2c01              CMP      r4,#1                 ;720
00085a  d10a              BNE      |L1.2162|
00085c  f89d0014          LDRB     r0,[sp,#0x14]         ;720
000860  b938              CBNZ     r0,|L1.2162|
000862  4639              MOV      r1,r7                 ;725
000864  4648              MOV      r0,r9                 ;725
000866  f7fffffe          BL       _DeactivateMenu
00086a  4639              MOV      r1,r7                 ;726
00086c  4648              MOV      r0,r9                 ;726
00086e  f7fffffe          BL       _ClosePopup
                  |L1.2162|
000872  4639              MOV      r1,r7                 ;728
000874  4648              MOV      r0,r9                 ;728
000876  f7fffffe          BL       _DeselectItem
00087a  4633              MOV      r3,r6                 ;729
00087c  462a              MOV      r2,r5                 ;729
00087e  4639              MOV      r1,r7                 ;729
000880  4648              MOV      r0,r9                 ;729
000882  f7fffffe          BL       _ForwardMouseOverMsg
000886  2001              MOVS     r0,#1                 ;731
000888  e7e3              B        |L1.2130|
;;;733    
                          ENDP

                  _ForwardPIDMsgToOwner PROC
;;;737    */
;;;738    static void _ForwardPIDMsgToOwner(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
00088a  e92d47f0          PUSH     {r4-r10,lr}
00088e  4680              MOV      r8,r0
000890  460e              MOV      r6,r1
000892  4614              MOV      r4,r2
;;;739      if (_IsTopLevelMenu(hObj, pObj) == 0) {
000894  4631              MOV      r1,r6
000896  4640              MOV      r0,r8
000898  f7fffffe          BL       _IsTopLevelMenu
00089c  bb58              CBNZ     r0,|L1.2294|
;;;740        WM_HWIN hOwner;
;;;741        hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
00089e  f8b6005c          LDRH     r0,[r6,#0x5c]
0008a2  b110              CBZ      r0,|L1.2218|
0008a4  f9b6005c          LDRSH    r0,[r6,#0x5c]
0008a8  e002              B        |L1.2224|
                  |L1.2218|
0008aa  4640              MOV      r0,r8
0008ac  f7fffffe          BL       WM_GetParent
                  |L1.2224|
0008b0  4607              MOV      r7,r0
;;;742        if (hOwner) {
0008b2  b1ff              CBZ      r7,|L1.2292|
;;;743          if (pMsg->Data.p) {
0008b4  68a0              LDR      r0,[r4,#8]
0008b6  b1c8              CBZ      r0,|L1.2284|
;;;744            GUI_PID_STATE* pState;
;;;745            pState = (GUI_PID_STATE*)pMsg->Data.p;
0008b8  68a5              LDR      r5,[r4,#8]
;;;746            pState->x += WM_GetWindowOrgX(hObj) - WM_GetWindowOrgX(hOwner);
0008ba  4640              MOV      r0,r8
0008bc  f7fffffe          BL       WM_GetWindowOrgX
0008c0  4681              MOV      r9,r0
0008c2  4638              MOV      r0,r7
0008c4  f7fffffe          BL       WM_GetWindowOrgX
0008c8  eba90000          SUB      r0,r9,r0
0008cc  6829              LDR      r1,[r5,#0]
0008ce  4408              ADD      r0,r0,r1
0008d0  6028              STR      r0,[r5,#0]
;;;747            pState->y += WM_GetWindowOrgY(hObj) - WM_GetWindowOrgY(hOwner);
0008d2  4640              MOV      r0,r8
0008d4  f7fffffe          BL       WM_GetWindowOrgY
0008d8  4681              MOV      r9,r0
0008da  4638              MOV      r0,r7
0008dc  f7fffffe          BL       WM_GetWindowOrgY
0008e0  eba90000          SUB      r0,r9,r0
0008e4  6869              LDR      r1,[r5,#4]
0008e6  4408              ADD      r0,r0,r1
0008e8  6068              STR      r0,[r5,#4]
;;;748          }
0008ea  bf00              NOP      
                  |L1.2284|
;;;749          WM__SendMessage(hOwner, pMsg);
0008ec  4621              MOV      r1,r4
0008ee  4638              MOV      r0,r7
0008f0  f7fffffe          BL       WM__SendMessage
                  |L1.2292|
;;;750        }
;;;751      }
0008f4  bf00              NOP      
                  |L1.2294|
;;;752    }
0008f6  e8bd87f0          POP      {r4-r10,pc}
;;;753    
                          ENDP

                  MENU__ResizeMenu PROC
;;;1061   */
;;;1062   void MENU__ResizeMenu(MENU_Handle hObj, MENU_Obj* pObj) {
0008fa  e92d41f0          PUSH     {r4-r8,lr}
0008fe  4604              MOV      r4,r0
000900  460d              MOV      r5,r1
;;;1063     int xSize, ySize;
;;;1064     xSize = _CalcWindowSizeX(hObj, pObj);
000902  4629              MOV      r1,r5
000904  4620              MOV      r0,r4
000906  f7fffffe          BL       _CalcWindowSizeX
00090a  4606              MOV      r6,r0
;;;1065     ySize = _CalcWindowSizeY(hObj, pObj);
00090c  4629              MOV      r1,r5
00090e  4620              MOV      r0,r4
000910  f7fffffe          BL       _CalcWindowSizeY
000914  4607              MOV      r7,r0
;;;1066     WM_SetSize(hObj, xSize, ySize);
000916  463a              MOV      r2,r7
000918  4631              MOV      r1,r6
00091a  4620              MOV      r0,r4
00091c  f7fffffe          BL       WM_SetSize
;;;1067     WM_InvalidateWindow(hObj);
000920  4620              MOV      r0,r4
000922  f7fffffe          BL       WM_InvalidateWindow
;;;1068   }
000926  e8bd81f0          POP      {r4-r8,pc}
;;;1069   
                          ENDP

                  _OnMenu PROC
;;;763    */
;;;764    static void _OnMenu(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
00092a  e92d41f0          PUSH     {r4-r8,lr}
00092e  4606              MOV      r6,r0
000930  460c              MOV      r4,r1
000932  4615              MOV      r5,r2
;;;765      const MENU_MSG_DATA* pData = (const MENU_MSG_DATA*)pMsg->Data.p;
000934  68af              LDR      r7,[r5,#8]
;;;766      if (pData) {
000936  2f00              CMP      r7,#0
000938  d048              BEQ      |L1.2508|
;;;767        switch (pData->MsgType) {
00093a  8838              LDRH     r0,[r7,#0]
00093c  2806              CMP      r0,#6
00093e  d244              BCS      |L1.2506|
000940  e8dff000          TBB      [pc,r0]
000944  03101124          DCB      0x03,0x10,0x11,0x24
000948  3b40              DCB      0x3b,0x40
;;;768        case MENU_ON_ITEMSELECT:
;;;769          _DeactivateMenu(hObj, pObj);
00094a  4621              MOV      r1,r4
00094c  4630              MOV      r0,r6
00094e  f7fffffe          BL       _DeactivateMenu
;;;770          _DeselectItem(hObj, pObj);
000952  4621              MOV      r1,r4
000954  4630              MOV      r0,r6
000956  f7fffffe          BL       _DeselectItem
;;;771          _ClosePopup(hObj, pObj);
00095a  4621              MOV      r1,r4
00095c  4630              MOV      r0,r6
00095e  f7fffffe          BL       _ClosePopup
;;;772          /* No break here. We need to forward message to owner. */
;;;773        case MENU_ON_INITMENU:
000962  bf00              NOP      
;;;774        case MENU_ON_INITSUBMENU:
000964  bf00              NOP      
;;;775          /* Forward message to owner. */
;;;776          {
;;;777            WM_HWIN hOwner;
;;;778            hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
000966  f8b4005c          LDRH     r0,[r4,#0x5c]
00096a  b110              CBZ      r0,|L1.2418|
00096c  f9b4005c          LDRSH    r0,[r4,#0x5c]
000970  e002              B        |L1.2424|
                  |L1.2418|
000972  4630              MOV      r0,r6
000974  f7fffffe          BL       WM_GetParent
                  |L1.2424|
000978  4680              MOV      r8,r0
;;;779            if (hOwner) {
00097a  f1b80f00          CMP      r8,#0
00097e  d004              BEQ      |L1.2442|
;;;780              pMsg->hWinSrc = hObj;
000980  80ee              STRH     r6,[r5,#6]
;;;781              WM__SendMessage(hOwner, pMsg);
000982  4629              MOV      r1,r5
000984  4640              MOV      r0,r8
000986  f7fffffe          BL       WM__SendMessage
                  |L1.2442|
;;;782            }
;;;783          }
;;;784          break;
00098a  e01e              B        |L1.2506|
;;;785        case MENU_ON_OPEN:
;;;786          pObj->Sel = -1;
00098c  f04f30ff          MOV      r0,#0xffffffff
000990  f104045c          ADD      r4,r4,#0x5c
000994  6120              STR      r0,[r4,#0x10]
;;;787          pObj->IsSubmenuActive = 0;
000996  f04f0000          MOV      r0,#0
00099a  7120              STRB     r0,[r4,#4]
;;;788          pObj->Flags |= MENU_SF_ACTIVE | MENU_SF_OPEN_ON_POINTEROVER;
00099c  8860              LDRH     r0,[r4,#2]
00099e  f0400042          ORR      r0,r0,#0x42
0009a2  8060              STRH     r0,[r4,#2]
0009a4  f1a4045c          SUB      r4,r4,#0x5c
;;;789          _SetCapture(hObj, pObj);
0009a8  4621              MOV      r1,r4
0009aa  4630              MOV      r0,r6
0009ac  f7fffffe          BL       _SetCapture
;;;790          MENU__ResizeMenu(hObj, pObj);
0009b0  4621              MOV      r1,r4
0009b2  4630              MOV      r0,r6
0009b4  f7fffffe          BL       MENU__ResizeMenu
;;;791          break;
0009b8  e007              B        |L1.2506|
;;;792        case MENU_ON_CLOSE:
;;;793          _CloseSubmenu(hObj, pObj);
0009ba  4621              MOV      r1,r4
0009bc  4630              MOV      r0,r6
0009be  f7fffffe          BL       _CloseSubmenu
;;;794          break;
0009c2  e002              B        |L1.2506|
;;;795        case MENU_IS_MENU:
;;;796          pMsg->Data.v = 1;
0009c4  2001              MOVS     r0,#1
0009c6  60a8              STR      r0,[r5,#8]
;;;797          break;
0009c8  bf00              NOP      
                  |L1.2506|
0009ca  bf00              NOP                            ;784
                  |L1.2508|
;;;798        }
;;;799      }
;;;800    }
0009cc  e8bd81f0          POP      {r4-r8,pc}
;;;801    
                          ENDP

                  _OnTouch PROC
;;;805    */
;;;806    static char _OnTouch(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
0009d0  b5f8              PUSH     {r3-r7,lr}
0009d2  4606              MOV      r6,r0
0009d4  460f              MOV      r7,r1
0009d6  4615              MOV      r5,r2
;;;807      const GUI_PID_STATE* pState = (const GUI_PID_STATE*)pMsg->Data.p;
0009d8  68ac              LDR      r4,[r5,#8]
;;;808      if (pState) {  /* Something happened in our area (pressed or released) */
0009da  b144              CBZ      r4,|L1.2542|
;;;809        return _HandlePID(hObj, pObj, pState->x, pState->y, pState->Pressed);
0009dc  7a20              LDRB     r0,[r4,#8]
0009de  9000              STR      r0,[sp,#0]
0009e0  4639              MOV      r1,r7
0009e2  4630              MOV      r0,r6
0009e4  e9d42300          LDRD     r2,r3,[r4,#0]
0009e8  f7fffffe          BL       _HandlePID
                  |L1.2540|
;;;810      }
;;;811      return _HandlePID(hObj, pObj, -1, -1, -1); /* Moved out */
;;;812    }
0009ec  bdf8              POP      {r3-r7,pc}
                  |L1.2542|
0009ee  f04f30ff          MOV      r0,#0xffffffff        ;811
0009f2  4603              MOV      r3,r0                 ;811
0009f4  4602              MOV      r2,r0                 ;811
0009f6  4639              MOV      r1,r7                 ;811
0009f8  9000              STR      r0,[sp,#0]            ;811
0009fa  4630              MOV      r0,r6                 ;811
0009fc  f7fffffe          BL       _HandlePID
000a00  e7f4              B        |L1.2540|
;;;813    
                          ENDP

                  _SetPaintColors PROC
;;;831    */
;;;832    static void _SetPaintColors(const MENU_Obj* pObj, const MENU_ITEM* pItem, int ItemIndex) {
000a02  e92d41f0          PUSH     {r4-r8,lr}
000a06  4604              MOV      r4,r0
000a08  460e              MOV      r6,r1
000a0a  4617              MOV      r7,r2
;;;833      char Selected;
;;;834      unsigned ColorIndex;
;;;835      Selected = (ItemIndex == pObj->Sel) ? 1 : 0;
000a0c  6ee0              LDR      r0,[r4,#0x6c]
000a0e  42b8              CMP      r0,r7
000a10  d101              BNE      |L1.2582|
000a12  2001              MOVS     r0,#1
000a14  e000              B        |L1.2584|
                  |L1.2582|
000a16  2000              MOVS     r0,#0
                  |L1.2584|
000a18  4680              MOV      r8,r0
;;;836      if (pObj->IsSubmenuActive && Selected) {
000a1a  f8940060          LDRB     r0,[r4,#0x60]
000a1e  b120              CBZ      r0,|L1.2602|
000a20  f1b80f00          CMP      r8,#0
000a24  d001              BEQ      |L1.2602|
;;;837        ColorIndex = MENU_CI_ACTIVE_SUBMENU;
000a26  2504              MOVS     r5,#4
000a28  e018              B        |L1.2652|
                  |L1.2602|
;;;838      } else if (pItem->Flags & MENU_IF_SEPARATOR) {
000a2a  88b0              LDRH     r0,[r6,#4]
000a2c  f0100f02          TST      r0,#2
000a30  d001              BEQ      |L1.2614|
;;;839        ColorIndex = MENU_CI_ENABLED;
000a32  2500              MOVS     r5,#0
000a34  e012              B        |L1.2652|
                  |L1.2614|
;;;840      } else {
;;;841        ColorIndex = (Selected) ? MENU_CI_SELECTED : MENU_CI_ENABLED;
000a36  f1b80f00          CMP      r8,#0
000a3a  d001              BEQ      |L1.2624|
000a3c  2001              MOVS     r0,#1
000a3e  e000              B        |L1.2626|
                  |L1.2624|
000a40  2000              MOVS     r0,#0
                  |L1.2626|
000a42  4605              MOV      r5,r0
;;;842        if (pItem->Flags & MENU_IF_DISABLED) {
000a44  88b0              LDRH     r0,[r6,#4]
000a46  f0100f01          TST      r0,#1
000a4a  d007              BEQ      |L1.2652|
;;;843          if (pObj->Flags & MENU_CF_HIDE_DISABLED_SEL) {
000a4c  f8b4005e          LDRH     r0,[r4,#0x5e]
000a50  f0100f08          TST      r0,#8
000a54  d001              BEQ      |L1.2650|
;;;844            ColorIndex = MENU_CI_DISABLED;
000a56  2502              MOVS     r5,#2
000a58  e000              B        |L1.2652|
                  |L1.2650|
;;;845          } else {
;;;846            ColorIndex += MENU_CI_DISABLED;
000a5a  1cad              ADDS     r5,r5,#2
                  |L1.2652|
;;;847          }
;;;848        }
;;;849      }
;;;850      GUI_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
000a5c  f104013c          ADD      r1,r4,#0x3c
000a60  f8510025          LDR      r0,[r1,r5,LSL #2]
000a64  f7fffffe          BL       GUI_SetBkColor
;;;851      GUI_SetColor(pObj->Props.aTextColor[ColorIndex]);
000a68  f1040128          ADD      r1,r4,#0x28
000a6c  f8510025          LDR      r0,[r1,r5,LSL #2]
000a70  f7fffffe          BL       GUI_SetColor
;;;852    }
000a74  e8bd81f0          POP      {r4-r8,pc}
;;;853    
                          ENDP

                  _OnPaint PROC
;;;857    */
;;;858    static void _OnPaint(MENU_Handle hObj, MENU_Obj* pObj) {
000a78  e92d4ff3          PUSH     {r0,r1,r4-r11,lr}
000a7c  b089              SUB      sp,sp,#0x24
000a7e  460c              MOV      r4,r1
;;;859      GUI_RECT FillRect, TextRect;
;;;860      MENU_ITEM* pItem;
;;;861      unsigned TextWidth, NumItems, i;
;;;862      U8 BorderLeft   = pObj->Props.aBorder[MENU_BI_LEFT];
000a80  f8949050          LDRB     r9,[r4,#0x50]
;;;863      U8 BorderTop    = pObj->Props.aBorder[MENU_BI_TOP];
000a84  f894a052          LDRB     r10,[r4,#0x52]
;;;864      int FontHeight  = GUI_GetYDistOfFont(pObj->Props.pFont);
000a88  6d60              LDR      r0,[r4,#0x54]
000a8a  f7fffffe          BL       GUI_GetYDistOfFont
000a8e  9003              STR      r0,[sp,#0xc]
;;;865      int EffectSize  = _GetEffectSize(hObj, pObj);
000a90  4621              MOV      r1,r4
000a92  9809              LDR      r0,[sp,#0x24]
000a94  f7fffffe          BL       _GetEffectSize
000a98  4607              MOV      r7,r0
;;;866      NumItems = MENU__GetNumItems(pObj);
000a9a  4620              MOV      r0,r4
000a9c  f7fffffe          BL       MENU__GetNumItems
000aa0  9004              STR      r0,[sp,#0x10]
;;;867      WM__GetClientRectWin(&pObj->Widget.Win, &FillRect);
000aa2  a907              ADD      r1,sp,#0x1c
000aa4  4620              MOV      r0,r4
000aa6  f7fffffe          BL       WM__GetClientRectWin
;;;868      GUI__ReduceRect(&FillRect, &FillRect, EffectSize);
000aaa  463a              MOV      r2,r7
000aac  a907              ADD      r1,sp,#0x1c
000aae  a807              ADD      r0,sp,#0x1c
000ab0  f7fffffe          BL       GUI__ReduceRect
;;;869      GUI_SetFont(pObj->Props.pFont);
000ab4  6d60              LDR      r0,[r4,#0x54]
000ab6  f7fffffe          BL       GUI_SetFont
;;;870      if (pObj->Flags & MENU_SF_VERTICAL) {
000aba  f8b4005e          LDRH     r0,[r4,#0x5e]
000abe  f0100f01          TST      r0,#1
000ac2  d06a              BEQ      |L1.2970|
;;;871        int ItemHeight, xSize;
;;;872        xSize = _CalcMenuSizeX(hObj, pObj);
000ac4  4621              MOV      r1,r4
000ac6  9809              LDR      r0,[sp,#0x24]
000ac8  f7fffffe          BL       _CalcMenuSizeX
000acc  9002              STR      r0,[sp,#8]
;;;873        FillRect.x1 = xSize - EffectSize - 1;
000ace  9802              LDR      r0,[sp,#8]
000ad0  1bc0              SUBS     r0,r0,r7
000ad2  1e40              SUBS     r0,r0,#1
000ad4  b200              SXTH     r0,r0
000ad6  f8ad0020          STRH     r0,[sp,#0x20]
;;;874        TextRect.x0 = FillRect.x0 + BorderLeft;
000ada  f8bd001c          LDRH     r0,[sp,#0x1c]
000ade  4448              ADD      r0,r0,r9
000ae0  b200              SXTH     r0,r0
000ae2  f8ad0014          STRH     r0,[sp,#0x14]
;;;875        for (i = 0; i < NumItems; i++) {
000ae6  2600              MOVS     r6,#0
000ae8  e053              B        |L1.2962|
                  |L1.2794|
;;;876          pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000aea  4631              MOV      r1,r6
000aec  f1040058          ADD      r0,r4,#0x58
000af0  f7fffffe          BL       GUI_ARRAY_GetpItem
000af4  4605              MOV      r5,r0
;;;877          ItemHeight = _GetItemHeight(hObj, pObj, i);
000af6  4632              MOV      r2,r6
000af8  4621              MOV      r1,r4
000afa  9809              LDR      r0,[sp,#0x24]
000afc  f7fffffe          BL       _GetItemHeight
000b00  4683              MOV      r11,r0
;;;878          _SetPaintColors(pObj, pItem, i);
000b02  4632              MOV      r2,r6
000b04  4629              MOV      r1,r5
000b06  4620              MOV      r0,r4
000b08  f7fffffe          BL       _SetPaintColors
;;;879          FillRect.y1 = FillRect.y0 + ItemHeight - 1;
000b0c  f8bd001e          LDRH     r0,[sp,#0x1e]
000b10  4458              ADD      r0,r0,r11
000b12  1e40              SUBS     r0,r0,#1
000b14  b200              SXTH     r0,r0
000b16  f8ad0022          STRH     r0,[sp,#0x22]
;;;880          if (pItem->Flags & MENU_IF_SEPARATOR) {
000b1a  88a8              LDRH     r0,[r5,#4]
000b1c  f0100f02          TST      r0,#2
000b20  d012              BEQ      |L1.2888|
;;;881            GUI_ClearRectEx(&FillRect);
000b22  a807              ADD      r0,sp,#0x1c
000b24  f7fffffe          BL       GUI_ClearRectEx
;;;882            GUI_SetColor(0x7C7C7C);
000b28  48fe              LDR      r0,|L1.3876|
000b2a  f7fffffe          BL       GUI_SetColor
;;;883            GUI_DrawHLine(FillRect.y0 + BorderTop + 1, FillRect.x0 + 2, FillRect.x1 - 2);
000b2e  f9bd3020          LDRSH    r3,[sp,#0x20]
000b32  1e9a              SUBS     r2,r3,#2
000b34  f9bd301c          LDRSH    r3,[sp,#0x1c]
000b38  1c99              ADDS     r1,r3,#2
000b3a  f9bd301e          LDRSH    r3,[sp,#0x1e]
000b3e  4453              ADD      r3,r3,r10
000b40  1c58              ADDS     r0,r3,#1
000b42  f7fffffe          BL       GUI_DrawHLine
000b46  e01d              B        |L1.2948|
                  |L1.2888|
;;;884          } else {
;;;885            TextWidth = pItem->TextWidth;
000b48  f8d58008          LDR      r8,[r5,#8]
;;;886            TextRect.x1 = TextRect.x0 + TextWidth - 1;
000b4c  f8bd0014          LDRH     r0,[sp,#0x14]
000b50  4440              ADD      r0,r0,r8
000b52  1e40              SUBS     r0,r0,#1
000b54  b200              SXTH     r0,r0
000b56  f8ad0018          STRH     r0,[sp,#0x18]
;;;887            TextRect.y0 = FillRect.y0 + BorderTop;
000b5a  f8bd001e          LDRH     r0,[sp,#0x1e]
000b5e  4450              ADD      r0,r0,r10
000b60  b200              SXTH     r0,r0
000b62  f8ad0016          STRH     r0,[sp,#0x16]
;;;888            TextRect.y1 = TextRect.y0 + FontHeight - 1;
000b66  f8bd1016          LDRH     r1,[sp,#0x16]
000b6a  9803              LDR      r0,[sp,#0xc]
000b6c  4408              ADD      r0,r0,r1
000b6e  1e40              SUBS     r0,r0,#1
000b70  b200              SXTH     r0,r0
000b72  f8ad001a          STRH     r0,[sp,#0x1a]
;;;889            WIDGET__FillStringInRect(pItem->acText, &FillRect, &TextRect, &TextRect);
000b76  ab05              ADD      r3,sp,#0x14
000b78  aa05              ADD      r2,sp,#0x14
000b7a  a907              ADD      r1,sp,#0x1c
000b7c  f105000c          ADD      r0,r5,#0xc
000b80  f7fffffe          BL       WIDGET__FillStringInRect
                  |L1.2948|
;;;890          }
;;;891          FillRect.y0 += ItemHeight;
000b84  f8bd001e          LDRH     r0,[sp,#0x1e]
000b88  4458              ADD      r0,r0,r11
000b8a  b200              SXTH     r0,r0
000b8c  f8ad001e          STRH     r0,[sp,#0x1e]
000b90  1c76              ADDS     r6,r6,#1              ;875
                  |L1.2962|
000b92  9804              LDR      r0,[sp,#0x10]         ;875
000b94  4286              CMP      r6,r0                 ;875
000b96  d3a8              BCC      |L1.2794|
;;;892        }
;;;893      } else {
000b98  e06a              B        |L1.3184|
                  |L1.2970|
;;;894        int ItemWidth, ySize;
;;;895        ySize = _CalcMenuSizeY(hObj, pObj);
000b9a  4621              MOV      r1,r4
000b9c  9809              LDR      r0,[sp,#0x24]
000b9e  f7fffffe          BL       _CalcMenuSizeY
000ba2  9002              STR      r0,[sp,#8]
;;;896        FillRect.y1 = ySize - EffectSize - 1;
000ba4  9802              LDR      r0,[sp,#8]
000ba6  1bc0              SUBS     r0,r0,r7
000ba8  1e40              SUBS     r0,r0,#1
000baa  b200              SXTH     r0,r0
000bac  f8ad0022          STRH     r0,[sp,#0x22]
;;;897        TextRect.y0 = FillRect.y0 + BorderTop;
000bb0  f8bd001e          LDRH     r0,[sp,#0x1e]
000bb4  4450              ADD      r0,r0,r10
000bb6  b200              SXTH     r0,r0
000bb8  f8ad0016          STRH     r0,[sp,#0x16]
;;;898        TextRect.y1 = TextRect.y0 + FontHeight - 1;
000bbc  f8bd1016          LDRH     r1,[sp,#0x16]
000bc0  9803              LDR      r0,[sp,#0xc]
000bc2  4408              ADD      r0,r0,r1
000bc4  1e40              SUBS     r0,r0,#1
000bc6  b200              SXTH     r0,r0
000bc8  f8ad001a          STRH     r0,[sp,#0x1a]
;;;899        for (i = 0; i < NumItems; i++) {
000bcc  2600              MOVS     r6,#0
000bce  e04b              B        |L1.3176|
                  |L1.3024|
;;;900          pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000bd0  4631              MOV      r1,r6
000bd2  f1040058          ADD      r0,r4,#0x58
000bd6  f7fffffe          BL       GUI_ARRAY_GetpItem
000bda  4605              MOV      r5,r0
;;;901          ItemWidth = _GetItemWidth(hObj, pObj, i);
000bdc  4632              MOV      r2,r6
000bde  4621              MOV      r1,r4
000be0  9809              LDR      r0,[sp,#0x24]
000be2  f7fffffe          BL       _GetItemWidth
000be6  4683              MOV      r11,r0
;;;902          _SetPaintColors(pObj, pItem, i);
000be8  4632              MOV      r2,r6
000bea  4629              MOV      r1,r5
000bec  4620              MOV      r0,r4
000bee  f7fffffe          BL       _SetPaintColors
;;;903          FillRect.x1 = FillRect.x0 + ItemWidth - 1;
000bf2  f8bd001c          LDRH     r0,[sp,#0x1c]
000bf6  4458              ADD      r0,r0,r11
000bf8  1e40              SUBS     r0,r0,#1
000bfa  b200              SXTH     r0,r0
000bfc  f8ad0020          STRH     r0,[sp,#0x20]
;;;904          if (pItem->Flags & MENU_IF_SEPARATOR) {
000c00  88a8              LDRH     r0,[r5,#4]
000c02  f0100f02          TST      r0,#2
000c06  d012              BEQ      |L1.3118|
;;;905            GUI_ClearRectEx(&FillRect);
000c08  a807              ADD      r0,sp,#0x1c
000c0a  f7fffffe          BL       GUI_ClearRectEx
;;;906            GUI_SetColor(0x7C7C7C);
000c0e  48c5              LDR      r0,|L1.3876|
000c10  f7fffffe          BL       GUI_SetColor
;;;907            GUI_DrawVLine(FillRect.x0 + BorderLeft + 1, FillRect.y0 + 2, FillRect.y1 - 2);
000c14  f9bd3022          LDRSH    r3,[sp,#0x22]
000c18  1e9a              SUBS     r2,r3,#2
000c1a  f9bd301e          LDRSH    r3,[sp,#0x1e]
000c1e  1c99              ADDS     r1,r3,#2
000c20  f9bd301c          LDRSH    r3,[sp,#0x1c]
000c24  444b              ADD      r3,r3,r9
000c26  1c58              ADDS     r0,r3,#1
000c28  f7fffffe          BL       GUI_DrawVLine
000c2c  e015              B        |L1.3162|
                  |L1.3118|
;;;908          } else {
;;;909            TextWidth = pItem->TextWidth;
000c2e  f8d58008          LDR      r8,[r5,#8]
;;;910            TextRect.x0 = FillRect.x0 + BorderLeft;
000c32  f8bd001c          LDRH     r0,[sp,#0x1c]
000c36  4448              ADD      r0,r0,r9
000c38  b200              SXTH     r0,r0
000c3a  f8ad0014          STRH     r0,[sp,#0x14]
;;;911            TextRect.x1 = TextRect.x0 + TextWidth - 1;
000c3e  f8bd0014          LDRH     r0,[sp,#0x14]
000c42  4440              ADD      r0,r0,r8
000c44  1e40              SUBS     r0,r0,#1
000c46  b200              SXTH     r0,r0
000c48  f8ad0018          STRH     r0,[sp,#0x18]
;;;912            WIDGET__FillStringInRect(pItem->acText, &FillRect, &TextRect, &TextRect);
000c4c  ab05              ADD      r3,sp,#0x14
000c4e  aa05              ADD      r2,sp,#0x14
000c50  a907              ADD      r1,sp,#0x1c
000c52  f105000c          ADD      r0,r5,#0xc
000c56  f7fffffe          BL       WIDGET__FillStringInRect
                  |L1.3162|
;;;913          }
;;;914          FillRect.x0 += ItemWidth;
000c5a  f8bd001c          LDRH     r0,[sp,#0x1c]
000c5e  4458              ADD      r0,r0,r11
000c60  b200              SXTH     r0,r0
000c62  f8ad001c          STRH     r0,[sp,#0x1c]
000c66  1c76              ADDS     r6,r6,#1              ;899
                  |L1.3176|
000c68  9804              LDR      r0,[sp,#0x10]         ;899
000c6a  4286              CMP      r6,r0                 ;899
000c6c  d3b0              BCC      |L1.3024|
;;;915        }
;;;916      }
000c6e  bf00              NOP      
                  |L1.3184|
;;;917      if (pObj->Width || pObj->Height) {
000c70  6e60              LDR      r0,[r4,#0x64]
000c72  b908              CBNZ     r0,|L1.3192|
000c74  6ea0              LDR      r0,[r4,#0x68]
000c76  b300              CBZ      r0,|L1.3258|
                  |L1.3192|
;;;918        GUI_RECT r;
;;;919        WM__GetClientRectWin(&pObj->Widget.Win, &r);
000c78  a901              ADD      r1,sp,#4
000c7a  4620              MOV      r0,r4
000c7c  f7fffffe          BL       WM__GetClientRectWin
;;;920        GUI__ReduceRect(&r, &r, EffectSize);
000c80  463a              MOV      r2,r7
000c82  a901              ADD      r1,sp,#4
000c84  a801              ADD      r0,sp,#4
000c86  f7fffffe          BL       GUI__ReduceRect
;;;921        GUI_SetBkColor(pObj->Props.aBkColor[MENU_CI_ENABLED]);
000c8a  6be0              LDR      r0,[r4,#0x3c]
000c8c  f7fffffe          BL       GUI_SetBkColor
;;;922        GUI_ClearRect(FillRect.x1 + 1, EffectSize, r.x1, FillRect.y1);
000c90  f9bd3022          LDRSH    r3,[sp,#0x22]
000c94  f9bd2008          LDRSH    r2,[sp,#8]
000c98  f9bd1020          LDRSH    r1,[sp,#0x20]
000c9c  1c48              ADDS     r0,r1,#1
000c9e  4639              MOV      r1,r7
000ca0  f7fffffe          BL       GUI_ClearRect
;;;923        GUI_ClearRect(EffectSize, FillRect.y1 + 1, r.x1, r.y1);
000ca4  f9bd300a          LDRSH    r3,[sp,#0xa]
000ca8  f9bd2008          LDRSH    r2,[sp,#8]
000cac  f9bd0022          LDRSH    r0,[sp,#0x22]
000cb0  1c41              ADDS     r1,r0,#1
000cb2  4638              MOV      r0,r7
000cb4  f7fffffe          BL       GUI_ClearRect
;;;924      }
000cb8  bf00              NOP      
                  |L1.3258|
;;;925      /* Draw 3D effect (if configured) */
;;;926      if (_HasEffect(hObj, pObj)) {
000cba  4621              MOV      r1,r4
000cbc  9809              LDR      r0,[sp,#0x24]
000cbe  f7fffffe          BL       _HasEffect
000cc2  b110              CBZ      r0,|L1.3274|
;;;927        pObj->Widget.pEffect->pfDrawUp();
000cc4  6a21              LDR      r1,[r4,#0x20]
000cc6  6808              LDR      r0,[r1,#0]
000cc8  4780              BLX      r0
                  |L1.3274|
;;;928      }
;;;929    }
000cca  b00b              ADD      sp,sp,#0x2c
000ccc  e8bd8ff0          POP      {r4-r11,pc}
;;;930    
                          ENDP

                  _MENU_Callback PROC
;;;934    */
;;;935    static void _MENU_Callback(WM_MESSAGE* pMsg) {
000cd0  b570              PUSH     {r4-r6,lr}
000cd2  4604              MOV      r4,r0
;;;936      MENU_Handle hObj;
;;;937      MENU_Obj* pObj;
;;;938      hObj = pMsg->hWin;
000cd4  f9b46004          LDRSH    r6,[r4,#4]
;;;939      if (pMsg->MsgId != WM_PID_STATE_CHANGED) {
000cd8  6820              LDR      r0,[r4,#0]
000cda  2811              CMP      r0,#0x11
000cdc  d005              BEQ      |L1.3306|
;;;940        /* Let widget handle the standard messages */
;;;941        if (WIDGET_HandleActive(hObj, pMsg) == 0) {
000cde  4621              MOV      r1,r4
000ce0  4630              MOV      r0,r6
000ce2  f7fffffe          BL       WIDGET_HandleActive
000ce6  b900              CBNZ     r0,|L1.3306|
                  |L1.3304|
;;;942          return;
;;;943        }
;;;944      }
;;;945      pObj = (MENU_Obj*) GUI_ALLOC_h2p(hObj);
;;;946      switch (pMsg->MsgId) {
;;;947      case WM_MENU:
;;;948        _OnMenu(hObj, pObj, pMsg);
;;;949        return;     /* Message handled, do not call WM_DefaultProc() here. */
;;;950      case WM_TOUCH:
;;;951        if (_OnTouch(hObj, pObj, pMsg)) {
;;;952          _ForwardPIDMsgToOwner(hObj, pObj, pMsg);
;;;953        }
;;;954        break;
;;;955    #if (GUI_SUPPORT_MOUSE)
;;;956      case WM_MOUSEOVER:
;;;957        if (_OnMouseOver(hObj, pObj, pMsg)) {
;;;958          _ForwardPIDMsgToOwner(hObj, pObj, pMsg);
;;;959        }
;;;960        break;
;;;961    #endif
;;;962      case WM_PAINT:
;;;963        _OnPaint(hObj, pObj);
;;;964        break;
;;;965      case WM_DELETE:
;;;966        GUI_ARRAY_Delete(&pObj->ItemArray);
;;;967        break;      /* No return here ... WM_DefaultProc needs to be called */
;;;968      }
;;;969      WM_DefaultProc(pMsg);
;;;970    }
000ce8  bd70              POP      {r4-r6,pc}
                  |L1.3306|
000cea  4630              MOV      r0,r6                 ;945
000cec  f7fffffe          BL       GUI_ALLOC_h2p
000cf0  4605              MOV      r5,r0                 ;945
000cf2  6820              LDR      r0,[r4,#0]            ;946
000cf4  280b              CMP      r0,#0xb               ;946
000cf6  d01c              BEQ      |L1.3378|
000cf8  280c              CMP      r0,#0xc               ;946
000cfa  d009              BEQ      |L1.3344|
000cfc  280f              CMP      r0,#0xf               ;946
000cfe  d013              BEQ      |L1.3368|
000d00  282c              CMP      r0,#0x2c              ;946
000d02  d11b              BNE      |L1.3388|
000d04  4622              MOV      r2,r4                 ;948
000d06  4629              MOV      r1,r5                 ;948
000d08  4630              MOV      r0,r6                 ;948
000d0a  f7fffffe          BL       _OnMenu
000d0e  e7eb              B        |L1.3304|
                  |L1.3344|
000d10  4622              MOV      r2,r4                 ;951
000d12  4629              MOV      r1,r5                 ;951
000d14  4630              MOV      r0,r6                 ;951
000d16  f7fffffe          BL       _OnTouch
000d1a  b120              CBZ      r0,|L1.3366|
000d1c  4622              MOV      r2,r4                 ;952
000d1e  4629              MOV      r1,r5                 ;952
000d20  4630              MOV      r0,r6                 ;952
000d22  f7fffffe          BL       _ForwardPIDMsgToOwner
                  |L1.3366|
000d26  e009              B        |L1.3388|
                  |L1.3368|
000d28  4629              MOV      r1,r5                 ;963
000d2a  4630              MOV      r0,r6                 ;963
000d2c  f7fffffe          BL       _OnPaint
000d30  e004              B        |L1.3388|
                  |L1.3378|
000d32  f1050058          ADD      r0,r5,#0x58           ;966
000d36  f7fffffe          BL       GUI_ARRAY_Delete
000d3a  bf00              NOP                            ;967
                  |L1.3388|
000d3c  bf00              NOP                            ;954
000d3e  4620              MOV      r0,r4                 ;969
000d40  f7fffffe          BL       WM_DefaultProc
000d44  bf00              NOP      
000d46  e7cf              B        |L1.3304|
;;;971    
                          ENDP

                  MENU_CreateEx PROC
;;;981    */
;;;982    MENU_Handle MENU_CreateEx(int x0, int y0, int xSize, int ySize, WM_HWIN hParent, int WinFlags, int ExFlags, int Id) {
000d48  e92d5fff          PUSH     {r0-r12,lr}
000d4c  4681              MOV      r9,r0
000d4e  468a              MOV      r10,r1
000d50  4616              MOV      r6,r2
000d52  461f              MOV      r7,r3
000d54  f8ddb038          LDR      r11,[sp,#0x38]
000d58  9d10              LDR      r5,[sp,#0x40]
;;;983      MENU_Handle hObj;
;;;984      /* Create the window */
;;;985      hObj = WM_CreateWindowAsChild(x0, y0, xSize, ySize, hParent, WM_CF_SHOW | WM_CF_STAYONTOP | WinFlags, &_MENU_Callback,
000d5a  2150              MOVS     r1,#0x50
000d5c  4a72              LDR      r2,|L1.3880|
000d5e  980f              LDR      r0,[sp,#0x3c]
000d60  b280              UXTH     r0,r0
000d62  f040000a          ORR      r0,r0,#0xa
000d66  463b              MOV      r3,r7
000d68  e9cdb000          STRD     r11,r0,[sp,#0]
000d6c  e9cd2102          STRD     r2,r1,[sp,#8]
000d70  4632              MOV      r2,r6
000d72  4651              MOV      r1,r10
000d74  4648              MOV      r0,r9
000d76  f7fffffe          BL       WM_CreateWindowAsChild
000d7a  4680              MOV      r8,r0
;;;986                                    sizeof(MENU_Obj) - sizeof(WM_Obj));
;;;987      if (hObj) {
000d7c  f1b80f00          CMP      r8,#0
000d80  d036              BEQ      |L1.3568|
;;;988        MENU_Obj* pObj;
;;;989        WM_LOCK();
000d82  f7fffffe          BL       GUI_Lock
;;;990        pObj = (MENU_Obj*)GUI_ALLOC_h2p(hObj);
000d86  4640              MOV      r0,r8
000d88  f7fffffe          BL       GUI_ALLOC_h2p
000d8c  4604              MOV      r4,r0
;;;991         /* Init sub-classes */
;;;992        GUI_ARRAY_CREATE(&pObj->ItemArray);
;;;993        /* init widget specific variables */
;;;994        WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
000d8e  2210              MOVS     r2,#0x10
000d90  4620              MOV      r0,r4
000d92  9911              LDR      r1,[sp,#0x44]
000d94  f7fffffe          BL       WIDGET__Init
;;;995        /* init member variables */
;;;996        if (ExFlags & MENU_SF_OPEN_ON_POINTEROVER) {
000d98  f0150f02          TST      r5,#2
000d9c  d002              BEQ      |L1.3492|
;;;997          ExFlags |= MENU_SF_ACTIVE;
000d9e  f0450540          ORR      r5,r5,#0x40
000da2  e001              B        |L1.3496|
                  |L1.3492|
;;;998        } else {
;;;999          ExFlags &= ~(MENU_SF_ACTIVE);
000da4  f0250540          BIC      r5,r5,#0x40
                  |L1.3496|
;;;1000       }
;;;1001       pObj->Props           = MENU__DefaultProps;
000da8  2230              MOVS     r2,#0x30
000daa  4960              LDR      r1,|L1.3884|
000dac  f1040028          ADD      r0,r4,#0x28
000db0  f7fffffe          BL       __aeabi_memcpy4
;;;1002       pObj->Flags           = ExFlags;
000db4  f8a4505e          STRH     r5,[r4,#0x5e]
;;;1003       pObj->Width           = ((xSize > 0) ? xSize : 0);
000db8  2e00              CMP      r6,#0
000dba  dd01              BLE      |L1.3520|
000dbc  4630              MOV      r0,r6
000dbe  e000              B        |L1.3522|
                  |L1.3520|
000dc0  2000              MOVS     r0,#0
                  |L1.3522|
000dc2  6660              STR      r0,[r4,#0x64]
;;;1004       pObj->Height          = ((ySize > 0) ? ySize : 0);
000dc4  2f00              CMP      r7,#0
000dc6  dd01              BLE      |L1.3532|
000dc8  4638              MOV      r0,r7
000dca  e000              B        |L1.3534|
                  |L1.3532|
000dcc  2000              MOVS     r0,#0
                  |L1.3534|
000dce  66a0              STR      r0,[r4,#0x68]
;;;1005       pObj->Sel             = -1;
000dd0  f04f30ff          MOV      r0,#0xffffffff
000dd4  66e0              STR      r0,[r4,#0x6c]
;;;1006       pObj->hOwner          = 0;
000dd6  2000              MOVS     r0,#0
000dd8  f8a4005c          STRH     r0,[r4,#0x5c]
;;;1007       pObj->IsSubmenuActive = 0;
000ddc  f8840060          STRB     r0,[r4,#0x60]
;;;1008       WIDGET_SetEffect(hObj, MENU__pDefaultEffect);
000de0  4853              LDR      r0,|L1.3888|
000de2  6801              LDR      r1,[r0,#0]  ; MENU__pDefaultEffect
000de4  4640              MOV      r0,r8
000de6  f7fffffe          BL       WIDGET_SetEffect
;;;1009       INIT_ID(pObj);
;;;1010       WM_UNLOCK();
000dea  f7fffffe          BL       GUI_Unlock
;;;1011     } else {
000dee  bf00              NOP      
                  |L1.3568|
;;;1012       GUI_DEBUG_ERROROUT_IF(hObj==0, "MENU_CreateEx failed")
;;;1013     }
;;;1014     return hObj;
000df0  4640              MOV      r0,r8
;;;1015   }
000df2  b004              ADD      sp,sp,#0x10
000df4  e8bd9ff0          POP      {r4-r12,pc}
;;;1016   
                          ENDP

                  MENU__RecalcTextWidthOfItems PROC
;;;1044   */
;;;1045   void MENU__RecalcTextWidthOfItems(MENU_Obj* pObj) {
000df8  e92d41f0          PUSH     {r4-r8,lr}
000dfc  4604              MOV      r4,r0
;;;1046     const GUI_FONT GUI_UNI_PTR* pOldFont;
;;;1047     MENU_ITEM* pItem;
;;;1048     unsigned i, NumItems;
;;;1049     NumItems = MENU__GetNumItems(pObj);
000dfe  4620              MOV      r0,r4
000e00  f7fffffe          BL       MENU__GetNumItems
000e04  4680              MOV      r8,r0
;;;1050     pOldFont  = GUI_SetFont(pObj->Props.pFont);
000e06  6d60              LDR      r0,[r4,#0x54]
000e08  f7fffffe          BL       GUI_SetFont
000e0c  4607              MOV      r7,r0
;;;1051     for (i = 0; i < NumItems; i++) {
000e0e  2600              MOVS     r6,#0
000e10  e00b              B        |L1.3626|
                  |L1.3602|
;;;1052       pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000e12  4631              MOV      r1,r6
000e14  f1040058          ADD      r0,r4,#0x58
000e18  f7fffffe          BL       GUI_ARRAY_GetpItem
000e1c  4605              MOV      r5,r0
;;;1053       pItem->TextWidth = GUI_GetStringDistX(pItem->acText);
000e1e  f105000c          ADD      r0,r5,#0xc
000e22  f7fffffe          BL       GUI_GetStringDistX
000e26  60a8              STR      r0,[r5,#8]
000e28  1c76              ADDS     r6,r6,#1              ;1051
                  |L1.3626|
000e2a  4546              CMP      r6,r8                 ;1051
000e2c  d3f1              BCC      |L1.3602|
;;;1054     }
;;;1055     GUI_SetFont(pOldFont);
000e2e  4638              MOV      r0,r7
000e30  f7fffffe          BL       GUI_SetFont
;;;1056   }
000e34  e8bd81f0          POP      {r4-r8,pc}
;;;1057   
                          ENDP

                  MENU__SetItem PROC
;;;1073   */
;;;1074   char MENU__SetItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index, const MENU_ITEM_DATA* pItemData) {
000e38  e92d47ff          PUSH     {r0-r10,lr}
000e3c  4607              MOV      r7,r0
000e3e  460d              MOV      r5,r1
000e40  4690              MOV      r8,r2
000e42  461c              MOV      r4,r3
;;;1075     MENU_ITEM Item = {0};
000e44  2000              MOVS     r0,#0
000e46  9000              STR      r0,[sp,#0]
000e48  9001              STR      r0,[sp,#4]
000e4a  9002              STR      r0,[sp,#8]
000e4c  9003              STR      r0,[sp,#0xc]
;;;1076     const char* pText;
;;;1077     pText = pItemData->pText;
000e4e  6826              LDR      r6,[r4,#0]
;;;1078     if (!pText) {
000e50  b906              CBNZ     r6,|L1.3668|
;;;1079       pText = "";
000e52  a638              ADR      r6,|L1.3892|
                  |L1.3668|
;;;1080     }
;;;1081     Item.Id        = pItemData->Id;
000e54  88a0              LDRH     r0,[r4,#4]
000e56  f8ad0002          STRH     r0,[sp,#2]
;;;1082     Item.Flags     = pItemData->Flags;
000e5a  88e0              LDRH     r0,[r4,#6]
000e5c  f8ad0004          STRH     r0,[sp,#4]
;;;1083     Item.hSubmenu  = pItemData->hSubmenu;
000e60  8920              LDRH     r0,[r4,#8]
000e62  f8ad0000          STRH     r0,[sp,#0]
;;;1084     Item.TextWidth = _CalcTextWidth(pObj, pText);
000e66  4631              MOV      r1,r6
000e68  4628              MOV      r0,r5
000e6a  f7fffffe          BL       _CalcTextWidth
000e6e  9002              STR      r0,[sp,#8]
;;;1085     if (Item.Flags & MENU_IF_SEPARATOR) {
000e70  f8bd0004          LDRH     r0,[sp,#4]
000e74  f0100f02          TST      r0,#2
000e78  d002              BEQ      |L1.3712|
;;;1086       Item.hSubmenu = 0;   /* Ensures that no separator is a submenu */
000e7a  2000              MOVS     r0,#0
000e7c  f8ad0000          STRH     r0,[sp,#0]
                  |L1.3712|
;;;1087     }
;;;1088     if (GUI_ARRAY_SetItem(&pObj->ItemArray, Index, &Item, sizeof(MENU_ITEM) + strlen(pText)) != 0) {
000e80  4630              MOV      r0,r6
000e82  f7fffffe          BL       strlen
000e86  f1000910          ADD      r9,r0,#0x10
000e8a  464b              MOV      r3,r9
000e8c  466a              MOV      r2,sp
000e8e  4641              MOV      r1,r8
000e90  f1050058          ADD      r0,r5,#0x58
000e94  f7fffffe          BL       GUI_ARRAY_SetItem
000e98  b198              CBZ      r0,|L1.3778|
;;;1089       MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000e9a  4641              MOV      r1,r8
000e9c  f1050058          ADD      r0,r5,#0x58
000ea0  f7fffffe          BL       GUI_ARRAY_GetpItem
000ea4  4681              MOV      r9,r0
;;;1090       strcpy(pItem->acText, pText);
000ea6  4631              MOV      r1,r6
000ea8  f109000c          ADD      r0,r9,#0xc
000eac  f7fffffe          BL       strcpy
;;;1091       MENU_SetOwner(Item.hSubmenu, hObj);
000eb0  f9bd0000          LDRSH    r0,[sp,#0]
000eb4  4639              MOV      r1,r7
000eb6  f7fffffe          BL       MENU_SetOwner
;;;1092       return 1;
000eba  2001              MOVS     r0,#1
                  |L1.3772|
;;;1093     }
;;;1094     return 0;
;;;1095   }
000ebc  b004              ADD      sp,sp,#0x10
000ebe  e8bd87f0          POP      {r4-r10,pc}
                  |L1.3778|
000ec2  2000              MOVS     r0,#0                 ;1094
000ec4  e7fa              B        |L1.3772|
;;;1096   
                          ENDP

                  MENU__SetItemFlags PROC
;;;1100   */
;;;1101   void MENU__SetItemFlags(MENU_Obj* pObj, unsigned Index, U16 Mask, U16 Flags) {
000ec6  e92d41f0          PUSH     {r4-r8,lr}
000eca  4605              MOV      r5,r0
000ecc  4688              MOV      r8,r1
000ece  4616              MOV      r6,r2
000ed0  461f              MOV      r7,r3
;;;1102     MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000ed2  4641              MOV      r1,r8
000ed4  f1050058          ADD      r0,r5,#0x58
000ed8  f7fffffe          BL       GUI_ARRAY_GetpItem
000edc  4604              MOV      r4,r0
;;;1103     pItem->Flags &= ~Mask;
000ede  88a0              LDRH     r0,[r4,#4]
000ee0  43b0              BICS     r0,r0,r6
000ee2  80a0              STRH     r0,[r4,#4]
;;;1104     pItem->Flags |= Flags;
000ee4  88a0              LDRH     r0,[r4,#4]
000ee6  4338              ORRS     r0,r0,r7
000ee8  80a0              STRH     r0,[r4,#4]
;;;1105   }
000eea  e8bd81f0          POP      {r4-r8,pc}
;;;1106   
                          ENDP

                  MENU_AddItem PROC
;;;1138   */
;;;1139   void MENU_AddItem(MENU_Handle hObj, const MENU_ITEM_DATA* pItemData) {
000eee  e92d41f0          PUSH     {r4-r8,lr}
000ef2  4606              MOV      r6,r0
000ef4  460d              MOV      r5,r1
;;;1140     if (hObj && pItemData) {
000ef6  b396              CBZ      r6,|L1.3934|
000ef8  b38d              CBZ      r5,|L1.3934|
;;;1141       MENU_Obj* pObj;
;;;1142       WM_LOCK();
000efa  f7fffffe          BL       GUI_Lock
;;;1143       pObj = MENU_H2P(hObj);
000efe  4630              MOV      r0,r6
000f00  f7fffffe          BL       GUI_ALLOC_h2p
000f04  4604              MOV      r4,r0
;;;1144       if (pObj) {
000f06  b33c              CBZ      r4,|L1.3928|
;;;1145         if (GUI_ARRAY_AddItem(&pObj->ItemArray, NULL, 0) == 0) {
000f08  2200              MOVS     r2,#0
000f0a  4611              MOV      r1,r2
000f0c  f1040058          ADD      r0,r4,#0x58
000f10  f7fffffe          BL       GUI_ARRAY_AddItem
000f14  bb00              CBNZ     r0,|L1.3928|
;;;1146           unsigned Index;
;;;1147           Index = MENU__GetNumItems(pObj) - 1;
000f16  4620              MOV      r0,r4
000f18  f7fffffe          BL       MENU__GetNumItems
000f1c  1e47              SUBS     r7,r0,#1
;;;1148           if (MENU__SetItem(hObj, pObj, Index, pItemData) == 0) {
000f1e  462b              MOV      r3,r5
000f20  463a              MOV      r2,r7
000f22  e009              B        |L1.3896|
                  |L1.3876|
                          DCD      0x007c7c7c
                  |L1.3880|
                          DCD      _MENU_Callback
                  |L1.3884|
                          DCD      MENU__DefaultProps
                  |L1.3888|
                          DCD      MENU__pDefaultEffect
                  |L1.3892|
000f34  00                DCB      0
000f35  00                DCB      0
000f36  00                DCB      0
000f37  00                DCB      0
                  |L1.3896|
000f38  4621              MOV      r1,r4
000f3a  4630              MOV      r0,r6
000f3c  f7fffffe          BL       MENU__SetItem
000f40  b928              CBNZ     r0,|L1.3918|
;;;1149             GUI_ARRAY_DeleteItem(&pObj->ItemArray, Index);
000f42  4639              MOV      r1,r7
000f44  f1040058          ADD      r0,r4,#0x58
000f48  f7fffffe          BL       GUI_ARRAY_DeleteItem
000f4c  e003              B        |L1.3926|
                  |L1.3918|
;;;1150           } else {
;;;1151             MENU__ResizeMenu(hObj, pObj);
000f4e  4621              MOV      r1,r4
000f50  4630              MOV      r0,r6
000f52  f7fffffe          BL       MENU__ResizeMenu
                  |L1.3926|
;;;1152           }
;;;1153         }
000f56  bf00              NOP      
                  |L1.3928|
;;;1154       }
;;;1155       WM_UNLOCK();
000f58  f7fffffe          BL       GUI_Unlock
;;;1156     }
000f5c  bf00              NOP      
                  |L1.3934|
;;;1157   }
000f5e  e8bd81f0          POP      {r4-r8,pc}
;;;1158   
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  MENU__DefaultProps
                          DCD      0x00000000
                          DCD      0x00ffffff
                          DCD      0x007c7c7c
                          DCD      0x00d3d3d3
                          DCD      0x00ffffff
                          DCD      0x00d3d3d3
                          DCD      0x00980000
                          DCD      0x00d3d3d3
                          DCD      0x00980000
                          DCD      0x007c7c7c
000028  04040202          DCB      0x04,0x04,0x02,0x02
                          DCD      GUI_Font13_1
                  MENU__pDefaultEffect
                          DCD      WIDGET_Effect_3D1L
